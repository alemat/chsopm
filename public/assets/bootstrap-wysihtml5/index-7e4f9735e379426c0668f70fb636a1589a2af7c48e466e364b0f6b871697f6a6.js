Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&function(){var t=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return t.get.call(this)},set:function(e){return t.set.call(this,e)}})}(),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var wysihtml5={version:"0.4.13",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};!function(e,t){"function"==typeof define&&define.amd?define(e):t.rangy=e()}(function(){function c(e,t){var n=typeof e[t];return n==w||!(n!=v||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=v||!e[t])}function e(e,t){return typeof e[t]!=b}function n(o){return function(e,t){for(var n=t.length;n--;)if(!o(e,t[n]))return!1;return!0}}function d(e){return e&&S(e,E)&&R(e,N)}function u(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function h(e){t(window,"console")&&c(window.console,"log")&&window.console.log(e)}function o(e,t){t?window.alert(e):h(e)}function f(e){A.initialized=!0,A.supported=!1,o("Rangy is not supported on this page in your browser. Reason: "+e,A.config.alertOnFail)}function r(e){o("Rangy warning: "+e,A.config.alertOnWarn)}function m(e){return e.message||e.description||String(e)}function i(){if(!A.initialized){var e,t=!1,n=!1;c(document,"createRange")&&(e=document.createRange(),S(e,x)&&R(e,C)&&(t=!0));var o=u(document);if(o&&"body"==o.nodeName.toLowerCase())if(o&&c(o,"createTextRange")&&d(e=o.createTextRange())&&(n=!0),t||n){var r;for(var i in A.initialized=!0,A.features={implementsDomRange:t,implementsTextRange:n},_)(r=_[i])instanceof p&&r.init(r,A);for(var a=0,s=O.length;a<s;++a)try{O[a](A)}catch(l){h("Rangy init listener threw an exception. Continuing. Detail: "+m(l))}}else f("Neither Range nor TextRange are available");else f("No body element found")}}function a(e){e=e||window,i();for(var t=0,n=I.length;t<n;++t)I[t](e)}function p(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function s(e,o,t,r){var n=new p(o,t,function(e){if(!e.initialized){e.initialized=!0;try{r(A,e),e.supported=!0}catch(n){var t="Module '"+o+"' failed to load: "+m(n);h(t)}}});_[o]=n}function l(){}function g(){}var y,v="object",w="function",b="undefined",C=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],x=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],N=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],E=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],S=n(c),T=n(t),R=n(e),_={},A={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:c,isHostObject:t,isHostProperty:e,areHostMethods:S,areHostObjects:T,areHostProperties:R,isTextRange:d,getBody:u},features:{},modules:_,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==b||rangyAutoInitialize}};A.fail=f,A.warn=r,!{}.hasOwnProperty?f("hasOwnProperty not supported"):A.util.extend=function(e,t,n){var o,r;for(var i in t)t.hasOwnProperty(i)&&(o=e[i],r=t[i],n&&null!==o&&"object"==typeof o&&null!==r&&"object"==typeof r&&A.util.extend(o,r,!0),e[i]=r);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t,n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(e){return n.call(e,0)})}catch(o){}t||(t=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}),A.util.toArray=t}(),c(document,"addEventListener")?y=function(e,t,n){e.addEventListener(t,n,!1)}:c(document,"attachEvent")?y=function(e,t,n){e.attachEvent("on"+t,n)}:f("Document does not have required addEventListener or attachEvent method"),A.util.addListener=y;var O=[];A.init=i,A.addInitListener=function(e){A.initialized?e(A):O.push(e)};var I=[];A.addShimListener=function(e){I.push(e)},A.shim=A.createMissingNativeApi=a,p.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,r=n.length;o<r;++o){if(t=n[o],!((e=_[t])&&e instanceof p))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){A.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){A.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},A.createModule=function(e,t,n){var o,r;2==arguments.length?(o=t,r=[]):(o=n,r=t);var i=s(!1,e,r,o);A.initialized&&i.init()},A.createCoreModule=function(e,t,n){s(!0,e,t,n)},A.RangePrototype=l,A.rangePrototype=new l,A.selectionPrototype=new g;var k=!1,L=function(){k||(k=!0,!A.initialized&&A.config.autoInitialize&&i())};if(typeof window!=b){if(typeof document!=b)return c(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",L,!1),y(window,"load",L),A.createCoreModule("DomUtil",[],function(n,c){function e(e){var t;return typeof e.namespaceURI==A||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function t(e){var t=e.parentNode;return 1==t.nodeType?t:null}function d(e){for(var t=0;e=e.previousSibling;)++t;return t}function o(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function u(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(D(o,n))return n;return null}function r(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function i(e,t){return r(e,t,!0)}function h(e,t,n){for(var o,r=n?e:e.parentNode;r;){if((o=r.parentNode)===t)return r;r=o}return null}function a(e){var t=e.nodeType;return 3==t||4==t||8==t}function s(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function l(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function f(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),l(o,e),n)for(var r,i=0;r=n[i++];)r.node==e&&r.offset>t?(r.node=o,r.offset-=t):r.node==e.parentNode&&r.offset>d(e)&&++r.offset;return o}function m(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=A)return e.ownerDocument;if(typeof e.document!=A)return e.document;if(e.parentNode)return m(e.parentNode);throw c.createError("getDocument: no document found for node")}function p(e){var t=m(e);if(typeof t.defaultView!=A)return t.defaultView;if(typeof t.parentWindow!=A)return t.parentWindow;throw c.createError("Cannot get a window object for node")}function g(e){if(typeof e.contentDocument!=A)return e.contentDocument;if(typeof e.contentWindow!=A)return e.contentWindow.document;throw c.createError("getIframeDocument: No Document object found for iframe element")}function y(e){if(typeof e.contentWindow!=A)return e.contentWindow;if(typeof e.contentDocument!=A)return e.contentDocument.defaultView;throw c.createError("getIframeWindow: No Window object found for iframe element")}function v(e){return e&&O.isHostMethod(e,"setTimeout")&&O.isHostObject(e,"document")}function w(e,t,n){var o;if(e?O.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?g(e):m(e):v(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function b(e){for(var t;t=e.parentNode;)e=t;return e}function C(e,t,n,o){var r,i,a,s,l;if(e==n)return t===o?0:t<o?-1:1;if(r=h(n,e,!0))return t<=d(r)?-1:1;if(r=h(e,n,!0))return d(r)<o?-1:1;if(!(i=u(e,n)))throw new Error("comparePoints error: nodes have no common ancestor");if((a=e===i?i:h(e,i,!0))===(s=n===i?i:h(n,i,!0)))throw c.createError("comparePoints got to case 4 and childA and childB are the same!");for(l=i.firstChild;l;){if(l===a)return-1;if(l===s)return 1;l=l.nextSibling}}function x(e){try{return e.parentNode,!1}catch(t){return!0}}function N(e){if(!e)return"[No node]";if(M&&x(e))return"[Broken node]";if(a(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+d(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function E(e){for(var t,n=m(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function S(e){this.root=e,this._next=e}function T(e){return new S(e)}function R(e,t){this.node=e,this.offset=t}function _(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var A="undefined",O=n.util;O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||c.fail("document missing a Node creation method"),O.isHostMethod(document,"getElementsByTagName")||c.fail("document missing getElementsByTagName method");var I=document.createElement("div");O.areHostMethods(I,["insertBefore","appendChild","cloneNode"])||c.fail("Incomplete Element implementation"),O.isHostProperty(I,"innerHTML")||c.fail("Element is missing innerHTML property");var k=document.createTextNode("test");O.areHostMethods(k,["splitText","deleteData","insertData","appendData","cloneNode"])||c.fail("Incomplete Text Node implementation");var L,D=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},M=!1;!function(){var e=document.createElement("b");e.innerHTML="1";var t=e.firstChild;e.innerHTML="<br>",M=x(t),n.features.crashyTextNodes=M}(),typeof window.getComputedStyle!=A?L=function(e,t){return p(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=A?L=function(e,t){return e.currentStyle[t]}:c.fail("No means of obtaining computed style properties found"),S.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},R.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+N(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},_.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},_.prototype.toString=function(){return this.message},n.dom={arrayContains:D,isHtmlNamespace:e,parentElement:t,getNodeIndex:d,getNodeLength:o,getCommonAncestor:u,isAncestorOf:r,isOrIsAncestorOf:i,getClosestAncestorIn:h,isCharacterDataNode:a,isTextOrCommentNode:s,insertAfter:l,splitDataNode:f,getDocument:m,getWindow:p,getIframeWindow:y,getIframeDocument:g,getBody:O.getBody,isWindow:v,getContentDocument:w,getRootContainer:b,comparePoints:C,isBrokenNode:x,inspectNode:N,getComputedStyleProperty:L,fragmentFromNodeChildren:E,createIterator:T,DomPosition:R},n.DOMException=_}),A.createCoreModule("DomRange",["DomUtil"],function(a){function o(e,t){return 3!=e.nodeType&&(q(e,t.startContainer)||q(e,t.endContainer))}function s(e){return e.document||V(e.startContainer)}function l(e){return new B(e.parentNode,z(e))}function d(e){return new B(e.parentNode,z(e)+1)}function n(e,t,n){var o=11==e.nodeType?e.firstChild:e;return H(t)?n==t.length?D.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:W(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function t(e,t,n){if(E(e),E(t),s(t)!=s(e))throw new P("WRONG_DOCUMENT_ERR");var o=U(e.startContainer,e.startOffset,t.endContainer,t.endOffset),r=U(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?o<=0&&0<=r:o<0&&0<r}function i(e){for(var t,n,o,r=s(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(o=e.getSubtreeIterator(),n.appendChild(i(o)),o.detach()),10==n.nodeType)throw new P("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function c(e,t,n){var o,r,i,a;for(n=n||{stop:!1};i=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(i))return void(n.stop=!0);if(c(a=e.getSubtreeIterator(),t,n),a.detach(),n.stop)return}else for(o=D.createIterator(i);r=o.next();)if(!1===t(r))return void(n.stop=!0)}function u(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(u(t=e.getSubtreeIterator()),t.detach()):e.remove()}function h(e){for(var t,n,o=s(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(h(n)),n.detach()):e.remove(),10==t.nodeType)throw new P("HIERARCHY_REQUEST_ERR");o.appendChild(t)}return o}function r(o,e,r){var i,a=!(!e||!e.length),s=!!r;a&&(i=new RegExp("^("+e.join("|")+")$"));var l=[];return c(new f(o,!1),function(e){if((!a||i.test(e.nodeType))&&(!s||r(e))){var t=o.startContainer;if(e!=t||!H(t)||o.startOffset!=t.length){var n=o.endContainer;e==n&&H(n)&&0==o.endOffset||l.push(e)}}}),l}function e(e){return"["+("undefined"==typeof e.getName?"Range":e.getName())+"("+D.inspectNode(e.startContainer)+":"+e.startOffset+", "+D.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function f(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&H(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||H(this.sc)?j(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||H(this.ec)?j(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(r){return function(e,t){for(var n,o=t?e:e.parentNode;o;){if(n=o.nodeType,K(r,n))return o;o=o.parentNode}return null}}function p(e,t){if(ne(e,t))throw new P("INVALID_NODE_TYPE_ERR")}function g(e,t){if(!K(t,e.nodeType))throw new P("INVALID_NODE_TYPE_ERR")}function y(e,t){if(t<0||t>(H(e)?e.length:e.childNodes.length))throw new P("INDEX_SIZE_ERR")}function v(e,t){if(ee(e,!0)!==ee(t,!0))throw new P("WRONG_DOCUMENT_ERR")}function w(e){if(te(e,!0))throw new P("NO_MODIFICATION_ALLOWED_ERR")}function b(e,t){if(!e)throw new P(t)}function C(e){return G&&D.isBrokenNode(e)||!K(Y,e.nodeType)&&!ee(e,!0)}function x(e,t){return t<=(H(e)?e.length:e.childNodes.length)}function N(e){return!!e.startContainer&&!!e.endContainer&&!C(e.startContainer)&&!C(e.endContainer)&&x(e.startContainer,e.startOffset)&&x(e.endContainer,e.endOffset)}function E(e){if(!N(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function S(e,t){E(e);var n=e.startContainer,o=e.startOffset,r=e.endContainer,i=e.endOffset,a=n===r;H(r)&&0<i&&i<r.length&&W(r,i,t),H(n)&&0<o&&o<n.length&&(n=W(n,o,t),a?(i-=o,r=n):r==n.parentNode&&i>=z(n)&&i++,o=0),e.setStartAndEnd(n,o,r,i)}function T(e){E(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function R(e){e.START_TO_START=se,e.START_TO_END=le,e.END_TO_END=ce,e.END_TO_START=de,e.NODE_BEFORE=ue,e.NODE_AFTER=he,e.NODE_BEFORE_AND_AFTER=fe,e.NODE_INSIDE=me}function _(e){R(e),R(e.prototype)}function A(a,s){return function(){E(this);var e,t=this.startContainer,n=this.startOffset,o=this.commonAncestorContainer,r=new f(this,!0);t!==o&&(t=(e=d(j(t,o,!0))).node,n=e.offset),c(r,w),r.reset();var i=a(r);return r.detach(),s(this,t,n,t,n),i}}function O(e,c){function t(n,o){return function(e){g(e,X),g($(e),Y);var t=(n?l:d)(e);(o?r:i)(this,t.node,t.offset)}}function r(e,t,n){var o=e.endContainer,r=e.endOffset;t===e.startContainer&&n===e.startOffset||($(t)==$(o)&&1!=U(t,n,o,r)||(o=t,r=n),c(e,t,n,o,r))}function i(e,t,n){var o=e.startContainer,r=e.startOffset;t===e.endContainer&&n===e.endOffset||($(t)==$(o)&&-1!=U(t,n,o,r)||(o=t,r=n),c(e,o,r,t,n))}var n=function(){};n.prototype=a.rangePrototype,e.prototype=new n,M.extend(e.prototype,{setStart:function(e,t){p(e,!0),y(e,t),r(this,e,t)},setEnd:function(e,t){p(e,!0),y(e,t),i(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],o=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:o=e[2],r=e[3]}c(this,t,n,o,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:t(!0,!0),setStartAfter:t(!1,!0),setEndBefore:t(!0,!1),setEndAfter:t(!1,!1),collapse:function(e){E(this),e?c(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):c(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){p(e,!0),c(this,e,0,e,F(e))},selectNode:function(e){p(e,!1),g(e,X);var t=l(e),n=d(e);c(this,t.node,t.offset,n.node,n.offset)},extractContents:A(h,c),deleteContents:A(u,c),canSurroundContents:function(){E(this),w(this.startContainer),w(this.endContainer);var e=new f(this,!0),t=e._first&&o(e._first,this)||e._last&&o(e._last,this);return e.detach(),!t},splitBoundaries:function(){S(this)},splitBoundariesPreservingPositions:function(e){S(this,e)},normalizeBoundaries:function(){E(this);var r=this.startContainer,i=this.startOffset,a=this.endContainer,s=this.endOffset,e=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(s=(a=e).length,e.appendData(t.data),t.parentNode.removeChild(t))},t=function(e){var t=e.previousSibling;if(t&&t.nodeType==e.nodeType){var n=(r=e).length;if(i=t.length,e.insertData(0,t.data),t.parentNode.removeChild(t),r==a)s+=i,a=r;else if(a==e.parentNode){var o=z(e);s==o?(a=e,s=n):o<s&&s--}}},n=!0;if(H(a))a.length==s&&e(a);else{if(0<s){var o=a.childNodes[s-1];o&&H(o)&&e(o)}n=!this.collapsed}if(n){if(H(r))0==i&&t(r);else if(i<r.childNodes.length){var l=r.childNodes[i];l&&H(l)&&t(l)}}else r=a,i=s;c(this,r,i,a,s)},collapseToPoint:function(e,t){p(e,!0),y(e,t),this.setStartAndEnd(e,t)}}),_(e)}function I(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:D.getCommonAncestor(e.startContainer,e.endContainer)}function k(e,t,n,o,r){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=r,e.document=D.getDocument(t),I(e)}function L(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,I(this)}var D=a.dom,M=a.util,B=D.DomPosition,P=a.DOMException,H=D.isCharacterDataNode,z=D.getNodeIndex,q=D.isOrIsAncestorOf,V=D.getDocument,U=D.comparePoints,W=D.splitDataNode,j=D.getClosestAncestorIn,F=D.getNodeLength,K=D.arrayContains,$=D.getRootContainer,G=a.features.crashyTextNodes;f.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,H(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!H(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return o(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new L(s(this.range));var t=this._current,n=t,o=0,r=t,i=F(t);q(t,this.sc)&&(n=this.sc,o=this.so),q(t,this.ec)&&(r=this.ec,i=this.eo),k(e,n,o,r,i)}return new f(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Y=[2,9,11],Q=[5,6,10,12],Z=[1,3,4,5,7,8,10,11],J=[1,3,4,5,7,8],ee=m([9,11]),te=m(Q),ne=m([6,10,12]),oe=document.createElement("style"),re=!1;try{oe.innerHTML="<b>x</b>",re=3==oe.firstChild.nodeType}catch(pe){}var ie=(a.features.htmlParsingConforms=re)?function(e){var t=this.startContainer,n=V(t);if(!t)throw new P("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:H(t)&&(o=D.parentElement(t)),(o=null===o||"HTML"==o.nodeName&&D.isHtmlNamespace(V(o).documentElement)&&D.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1)).innerHTML=e,D.fragmentFromNodeChildren(o)}:function(e){var t=s(this).createElement("body");return t.innerHTML=e,D.fragmentFromNodeChildren(t)},ae=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],se=0,le=1,ce=2,de=3,ue=0,he=1,fe=2,me=3;M.extend(a.rangePrototype,{compareBoundaryPoints:function(e,t){var n,o,r,i;E(this),v(this.startContainer,t.startContainer);var a=e==de||e==se?"start":"end",s=e==le||e==se?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],r=t[s+"Container"],i=t[s+"Offset"],U(n,o,r,i)},insertNode:function(e){if(E(this),g(e,Z),w(this.startContainer),q(e,this.startContainer))throw new P("HIERARCHY_REQUEST_ERR");var t=n(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if(E(this),this.collapsed)return s(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=s(this).createDocumentFragment()).appendChild(e),t;var n=new f(this,!0);return e=i(n),n.detach(),e},canSurroundContents:function(){E(this),w(this.startContainer),w(this.endContainer);var e=new f(this,!0),t=e._first&&o(e._first,this)||e._last&&o(e._last,this);return e.detach(),!t},surroundContents:function(e){if(g(e,J),!this.canSurroundContents())throw new P("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);n(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){E(this);for(var e,t=new L(s(this)),n=ae.length;n--;)t[e=ae[n]]=this[e];return t},toString:function(){E(this);var e=this.startContainer;if(e===this.endContainer&&H(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new f(this,!0);return c(n,function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){E(this);var t=e.parentNode,n=z(e);if(!t)throw new P("NOT_FOUND_ERR");var o=this.comparePoint(t,n),r=this.comparePoint(t,n+1);return o<0?0<r?fe:ue:0<r?he:me},comparePoint:function(e,t){return E(this),b(e,"HIERARCHY_REQUEST_ERR"),v(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)<0?-1:0<U(e,t,this.endContainer,this.endOffset)?1:0},createContextualFragment:ie,toHtml:function(){return T(this)},intersectsNode:function(e,t){if(E(this),b(e,"NOT_FOUND_ERR"),V(e)!==s(this))return!1;var n=e.parentNode,o=z(e);b(n,"NOT_FOUND_ERR");var r=U(n,o,this.endContainer,this.endOffset),i=U(n,o+1,this.startContainer,this.startOffset);return t?r<=0&&0<=i:r<0&&0<i},isPointInRange:function(e,t){return E(this),b(e,"HIERARCHY_REQUEST_ERR"),v(e,this.startContainer),0<=U(e,t,this.startContainer,this.startOffset)&&U(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return t(this,e,!1)},intersectsOrTouchesRange:function(e){return t(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=U(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=U(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==U(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==U(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new P("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==me},containsNodeContents:function(e){return 0<=this.comparePoint(e,0)&&this.comparePoint(e,F(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(0<n.length){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return E(this),r(this,e,t)},getDocument:function(){return s(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(e){var t=s(this),n=a.createRange(t);e=e||D.getBody(t),n.selectNodeContents(e);var o=this.intersection(n),r=0,i=0;return o&&(n.setEnd(o.startContainer,o.startOffset),i=(r=n.toString().length)+o.toString().length),{start:r,end:i,containerNode:e}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,r,i,a,s=[t],l=!1,c=!1;!c&&(o=s.pop());)if(3==o.nodeType)r=n+o.length,!l&&e.start>=n&&e.start<=r&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=r&&(this.setEnd(o,e.end-n),c=!0),n=r;else for(i=(a=o.childNodes).length;i--;)s.push(a[i])},getName:function(){return"DomRange"},equals:function(e){return L.rangesEqual(this,e)},isValid:function(){return N(this)},inspect:function(){return e(this)},detach:function(){}}),O(L,k),M.extend(L,{rangeProperties:ae,RangeIterator:f,copyComparisonConstants:_,createPrototypeRange:O,inspect:e,toHtml:T,getRangeDocument:s,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),a.DomRange=L}),A.createCoreModule("WrappedRange",["DomRange"],function(h,f){var m,e,x=h.dom,p=h.util,N=x.DomPosition,g=h.DomRange,y=x.getBody,v=x.getContentDocument,E=x.isCharacterDataNode;if(h.features.implementsDomRange&&function(){function o(e){for(var t,n=r.length;n--;)e[t=r[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function e(e,t,n,o,r){var i=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=r,s=!e.equals(e.nativeRange);(i||a||s)&&(e.setEnd(o,r),e.setStart(t,n))}var t,n,r=g.rangeProperties;m=function(e){if(!e)throw f.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},g.createPrototypeRange(m,e),(t=m.prototype).selectNode=function(e){this.nativeRange.selectNode(e),o(this)},t.cloneContents=function(){return this.nativeRange.cloneContents()},t.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},t.collapse=function(e){this.nativeRange.collapse(e),o(this)},t.cloneRange=function(){return new m(this.nativeRange.cloneRange())},t.refresh=function(){o(this)},t.toString=function(){return this.nativeRange.toString()};var i=document.createTextNode("test");y(document).appendChild(i);var a=document.createRange();a.setStart(i,0),a.setEnd(i,0);try{a.setStart(i,1),t.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},t.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},n=function(t){return function(e){this.nativeRange[t](e),o(this)}}}catch(u){t.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(Gk){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},t.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(Gk){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},n=function(t,n){return function(e){try{this.nativeRange[t](e)}catch(Gk){this.nativeRange[n](e),this.nativeRange[t](e)}o(this)}}}t.setStartBefore=n("setStartBefore","setEndBefore"),t.setStartAfter=n("setStartAfter","setEndAfter"),t.setEndBefore=n("setEndBefore","setStartBefore"),t.setEndAfter=n("setEndAfter","setStartAfter"),t.selectNodeContents=function(e){this.setStartAndEnd(e,0,x.getNodeLength(e))},a.selectNodeContents(i),a.setEnd(i,3);var s=document.createRange();s.selectNodeContents(i),s.setEnd(i,4),s.setStart(i,2),-1==a.compareBoundaryPoints(a.START_TO_END,s)&&1==a.compareBoundaryPoints(a.END_TO_START,s)?t.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:t.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var l=document.createElement("div");l.innerHTML="123";var c=l.firstChild,d=y(document);d.appendChild(l),a.setStart(c,1),a.setEnd(c,2),a.deleteContents(),"13"==c.data&&(t.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},t.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),d.removeChild(l),d=null,p.isHostMethod(a,"createContextualFragment")&&(t.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),y(document).removeChild(i),t.getName=function(){return"WrappedRange"},h.WrappedRange=m,h.createNativeRange=function(e){return(e=v(e,f,"createNativeRange")).createRange()}}(),h.features.implementsTextRange){var r=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();(n=e.duplicate()).collapse(!1);var r=n.parentElement(),i=o==r?o:x.getCommonAncestor(o,r);return i==t?i:x.getCommonAncestor(t,i)},i=function(e){return 0==e.compareEndPoints("StartToEnd",e)},a=function(e,t,n,o,r){var i=e.duplicate();i.collapse(n);var a=i.parentElement();if(x.isOrIsAncestorOf(t,a)||(a=t),!a.canHaveHTML){var s=new N(a.parentNode,x.getNodeIndex(a));return{boundaryPosition:s,nodeInfo:{nodeIndex:s.offset,containerElement:s.node}}}var l=x.getDocument(a).createElement("span");l.parentNode&&l.parentNode.removeChild(l);for(var c,d,u,h,f,m=n?"StartToStart":"StartToEnd",p=r&&r.containerElement==a?r.nodeIndex:0,g=a.childNodes.length,y=g,v=y;v==g?a.appendChild(l):a.insertBefore(l,a.childNodes[v]),i.moveToElementText(l),0!=(c=i.compareEndPoints(m,e))&&p!=y;){if(-1==c){if(y==p+1)break;p=v}else y=y==p+1?p:v;v=Math.floor((p+y)/2),a.removeChild(l)}if(f=l.nextSibling,-1==c&&f&&E(f)){var w;if(i.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(f.data)){var b=i.duplicate(),C=b.text.replace(/\r\n/g,"\r").length;for(w=b.moveStart("character",C);-1==(c=b.compareEndPoints("StartToEnd",b));)w++,b.moveStart("character",1)}else w=i.text.length;h=new N(f,w)}else d=(o||!n)&&l.previousSibling,h=(u=(o||n)&&l.nextSibling)&&E(u)?new N(u,0):d&&E(d)?new N(d,d.data.length):new N(a,x.getNodeIndex(l));return l.parentNode.removeChild(l),{boundaryPosition:h,nodeInfo:{nodeIndex:v,containerElement:a}}},s=function(e,t){var n,o,r,i,a=e.offset,s=x.getDocument(e.node),l=y(s).createTextRange(),c=E(e.node);return c?o=(n=e.node).parentNode:(n=a<(i=e.node.childNodes).length?i[a]:null,o=e.node),(r=s.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),l.moveToElementText(r),l.collapse(!t),o.removeChild(r),c&&l[t?"moveStart":"moveEnd"]("character",a),l};(e=function(e){this.textRange=e,this.refresh()}).prototype=new g(document),e.prototype.refresh=function(){var e,t,n,o=r(this.textRange);i(this.textRange)?t=e=a(this.textRange,o,!0,!0).boundaryPosition:(e=(n=a(this.textRange,o,!0,!1)).boundaryPosition,t=a(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},e.prototype.getName=function(){return"WrappedTextRange"},g.copyComparisonConstants(e);var t=function(e){if(e.collapsed)return s(new N(e.startContainer,e.startOffset),!0);var t=s(new N(e.startContainer,e.startOffset),!0),n=s(new N(e.endContainer,e.endOffset),!1),o=y(g.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(e.rangeToTextRange=t,e.prototype.toTextRange=function(){return t(this)},h.WrappedTextRange=e,!h.features.implementsDomRange||h.config.preferTextRange){var n=function(){return this}();"undefined"==typeof n.Range&&(n.Range=e),h.createNativeRange=function(e){return e=v(e,f,"createNativeRange"),y(e).createTextRange()},h.WrappedRange=e}}h.createRange=function(e){return e=v(e,f,"createRange"),new h.WrappedRange(h.createNativeRange(e))},h.createRangyRange=function(e){
return e=v(e,f,"createRangyRange"),new g(e)},h.createIframeRange=function(e){return f.deprecationNotice("createIframeRange()","createRange(iframeEl)"),h.createRange(e)},h.createIframeRangyRange=function(e){return f.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),h.createRangyRange(e)},h.addShimListener(function(e){var t=e.document;"undefined"==typeof t.createRange&&(t.createRange=function(){return h.createRange(t)}),t=e=null})}),A.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(h,c){function r(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function i(e,t){if(e){if(_.isWindow(e))return e;if(e instanceof v)return e.win;var n=_.getContentDocument(e,c,t);return _.getWindow(n)}return window}function e(e){return i(e,"getWinSelection").getSelection()}function a(e){return i(e,"getDocSelection").document.selection}function f(e){var t=!1;return e.anchorNode&&(t=1==_.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function s(e,t,n){var o=n?"end":"start",r=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[r+"Container"],e.focusOffset=t[r+"Offset"]}function o(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function l(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(e){var t;return e instanceof I?((t=h.createNativeRange(e.getDocument())).setEnd(e.endContainer,e.endOffset),t.setStart(e.startContainer,e.startOffset)):e instanceof k?t=e.nativeRange:M.implementsDomRange&&e instanceof _.getWindow(e.startContainer).Range&&(t=e),t}function n(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!_.isAncestorOf(e[0],e[t]))return!1;return!0}function u(e){var t=e.getNodes();if(!n(t))throw c.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function m(e){return!!e&&"undefined"!=typeof e.text}function p(e,t){var n=new k(t);e._ranges=[n],s(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function g(e){if(e._ranges.length=0,"None"==e.docSelection.type)l(e);else{var t=e.docSelection.createRange();if(m(t))p(e,t);else{e.rangeCount=t.length;for(var n,o=P(t.item(0)),r=0;r<e.rangeCount;++r)(n=h.createRange(o)).selectNode(t.item(r)),e._ranges.push(n);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,s(e,e._ranges[e.rangeCount-1],!1)}}}function y(e,t){for(var n=e.docSelection.createRange(),o=u(t),r=P(n.item(0)),i=H(r).createControlRange(),a=0,s=n.length;a<s;++a)i.add(n.item(a));try{i.add(o)}catch(l){throw c.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select(),g(e)}function v(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function w(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function b(e,t){for(var n,o,r=te.length;r--;)if(o=(n=te[r]).selection,"deleteAll"==t)w(o);else if(n.win==e)return"delete"==t?(te.splice(r,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function C(e,t){for(var n,o=P(t[0].startContainer),r=H(o).createControlRange(),i=0,a=t.length;i<a;++i){n=u(t[i]);try{r.add(n)}catch(s){throw c.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),g(e)}function x(e,t){if(e.win.document!=P(t))throw new L("WRONG_DOCUMENT_ERR")}function t(o){return function(e,t){var n;this.rangeCount?(n=this.getRangeAt(0))["set"+(o?"Start":"End")](e,t):(n=h.createRange(this.win.document)).setStartAndEnd(e,t),this.setSingleRange(n,this.isBackward())}}function N(e){var t=[],n=new D(e.anchorNode,e.anchorOffset),o=new D(e.focusNode,e.focusOffset),r="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var i=0,a=e.rangeCount;i<a;++i)t[i]=I.inspect(e.getRangeAt(i));return"["+r+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}h.config.checkSelectionRanges=!0;var E,S,T="boolean",R="number",_=h.dom,A=h.util,O=A.isHostMethod,I=h.DomRange,k=h.WrappedRange,L=h.DOMException,D=_.DomPosition,M=h.features,B="Control",P=_.getDocument,H=_.getBody,z=I.rangesEqual,q=O(window,"getSelection"),V=A.isHostObject(document,"selection");M.implementsWinGetSelection=q;var U=(M.implementsDocSelection=V)&&(!q||h.config.preferTextRange);U?(E=a,h.isSelectionValid=function(e){var t=i(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||P(n.createRange().parentElement())==t}):q?(E=e,h.isSelectionValid=function(){return!0}):c.fail("Neither document.selection or window.getSelection() detected.");var W=(h.getNativeSelection=E)(),j=h.createNativeRange(document),F=H(document),K=A.areHostProperties(W,["anchorNode","focusNode","anchorOffset","focusOffset"]);M.selectionHasAnchorAndFocus=K;var $=O(W,"extend");M.selectionHasExtend=$;var G=typeof W.rangeCount==R;M.selectionHasRangeCount=G;var X=!1,Y=!0,Q=$?function(e,t){var n=I.getRangeDocument(t),o=h.createRange(n);o.collapseToPoint(t.endContainer,t.endOffset),e.addRange(d(o)),e.extend(t.startContainer,t.startOffset)}:null;A.areHostMethods(W,["addRange","getRangeAt","removeAllRanges"])&&typeof W.rangeCount==R&&M.implementsDomRange&&function(){var e=window.getSelection();if(e){for(var t=e.rangeCount,n=1<t,o=[],r=f(e),i=0;i<t;++i)o[i]=e.getRangeAt(i);var a=H(document),s=a.appendChild(document.createElement("div"));s.contentEditable="false";var l=s.appendChild(document.createTextNode("\xa0\xa0\xa0")),c=document.createRange();if(c.setStart(l,1),c.collapse(!0),e.addRange(c),Y=1==e.rangeCount,e.removeAllRanges(),!n){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&36<=parseInt(d[1]))X=!1;else{var u=c.cloneRange();c.setStart(l,0),u.setEnd(l,3),u.setStart(l,2),e.addRange(c),e.addRange(u),X=2==e.rangeCount}}for(a.removeChild(s),e.removeAllRanges(),i=0;i<t;++i)0==i&&r?Q?Q(e,o[i]):(h.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(o[i])):e.addRange(o[i])}}(),M.selectionSupportsMultipleRanges=X,M.collapsedNonEditableSelectionsSupported=Y;var Z,J,ee=!1;F&&O(F,"createControlRange")&&(Z=F.createControlRange(),A.areHostProperties(Z,["item","add"])&&(ee=!0)),M.implementsControlRange=ee,S=K?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},O(W,"getRangeAt")?J=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:K&&(J=function(e){var t=P(e.anchorNode),n=h.createRange(t);return n.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),n.collapsed!==this.isCollapsed&&n.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),n}),v.prototype=h.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof v)return e.refresh(),e;var t=b(e=i(e,"getNativeSelection")),n=E(e),o=V?a(e):null;return t?(t.nativeSelection=n,t.docSelection=o,t.refresh()):(t=new v(n,o,e),te.push({win:e,selection:t})),t};h.getSelection=ne,h.getIframeSelection=function(e){return c.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),h.getSelection(_.getIframeWindow(e))};var oe,re=v.prototype;if(!U&&K&&A.areHostMethods(W,["removeAllRanges","addRange"])){re.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),l(this)};var ie=function(e,t){Q(e.nativeSelection,t),e.refresh()};re.addRange=G?function(e,t){var n;if(ee&&V&&this.docSelection.type==B)y(this,e);else if(r(t)&&$)ie(this,e);else if(X?n=this.rangeCount:(this.removeAllRanges(),n=0),this.nativeSelection.addRange(d(e).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==n+1){if(h.config.checkSelectionRanges){var o=J(this.nativeSelection,this.rangeCount-1);o&&!z(o,e)&&(e=new k(o))}this._ranges[this.rangeCount-1]=e,s(this,e,ae(this.nativeSelection)),this.isCollapsed=S(this)}else this.refresh()}:function(e,t){r(t)&&$?ie(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},re.setRanges=function(e){if(ee&&V&&1<e.length)C(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(O(W,"empty")&&O(j,"select")&&ee&&U))return c.fail("No means of selecting a Range or TextRange was found"),!1;re.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=P(this.anchorNode);else if(this.docSelection.type==B){var t=this.docSelection.createRange();t.length&&(e=P(t.item(0)))}if(e)H(e).createTextRange().select(),this.docSelection.empty()}}catch(n){}l(this)},re.addRange=function(e){this.docSelection.type==B?y(this,e):(h.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,s(this,e,!1))},re.setRanges=function(e){this.removeAllRanges();var t=e.length;1<t?C(this,e):t&&this.addRange(e[0])}}if(re.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new L("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},U)oe=function(e){var t;h.isSelectionValid(e.win)?t=e.docSelection.createRange():(t=H(e.win.document).createTextRange()).collapse(!0),e.docSelection.type==B?g(e):m(t)?p(e,t):l(e)};else if(O(W,"getRangeAt")&&typeof W.rangeCount==R)oe=function(e){if(ee&&V&&e.docSelection.type==B)g(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var t=0,n=e.rangeCount;t<n;++t)e._ranges[t]=new h.WrappedRange(e.nativeSelection.getRangeAt(t));s(e,e._ranges[e.rangeCount-1],ae(e.nativeSelection)),e.isCollapsed=S(e)}else l(e)};else{if(!K||typeof W.isCollapsed!=T||typeof j.collapsed!=T||!M.implementsDomRange)return c.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;oe=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=J(n,0),e._ranges=[t],e.rangeCount=1,o(e),e.isCollapsed=S(e)):l(e)}}re.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(oe(this),e){var r=t.length;if(r!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;r--;)if(!z(t[r],this._ranges[r]))return!0;return!1}};var ae,se=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,r=n.length;o<r;++o)z(t,n[o])||e.addRange(n[o]);e.rangeCount||l(e)};re.removeRange=ee&&V?function(e){if(this.docSelection.type==B){for(var t=this.docSelection.createRange(),n=u(e),o=P(t.item(0)),r=H(o).createControlRange(),i=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||i?r.add(t.item(a)):i=!0;r.select(),g(this)}else se(this,e)}:function(e){se(this,e)},!U&&K&&M.implementsDomRange?(ae=f,re.isBackward=function(){return ae(this)}):ae=re.isBackward=function(){return!1},re.isBackwards=re.isBackward,re.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},re.collapse=function(e,t){x(this,e);var n=h.createRange(e);n.collapseToPoint(e,t),this.setSingleRange(n),this.isCollapsed=!0},re.collapseToStart=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},re.collapseToEnd=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},re.selectAllChildren=function(e){x(this,e);var t=h.createRange(e);t.selectNodeContents(e),this.setSingleRange(t)},re.deleteFromDocument=function(){if(ee&&V&&this.docSelection.type==B){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,r=n.length;o<r;++o)n[o].deleteContents();this.addRange(n[r-1])}}},re.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},re.getAllRanges=function(){var t=[];return this.eachRange(function(e){t.push(e)}),t},re.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},re.callMethodOnEachRange=function(t,n){var o=[];return this.eachRange(function(e){o.push(e[t].apply(e,n))}),o},re.setStart=t(!0),re.setEnd=t(!1),h.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},re.changeEachRange=function(t){var n=[],e=this.isBackward();this.eachRange(function(e){t(e),n.push(e)}),this.removeAllRanges(),e&&1==n.length?this.addRange(n[0],"backward"):this.setRanges(n)},re.containsNode=function(t,n){return this.eachRange(function(e){return e.containsNode(t,n)},!0)||!1},re.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},re.moveToBookmark=function(e){for(var t,n,o=[],r=0;t=e.rangeBookmarks[r++];)(n=h.createRange(this.win)).moveToBookmark(t),o.push(n);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},re.toHtml=function(){var t=[];return this.eachRange(function(e){t.push(I.toHtml(e))}),t.join("")},M.implementsTextRange&&(re.getNativeTextRange=function(){var e;if(e=this.docSelection){var t=e.createRange();if(m(t))return t;throw c.createError("getNativeTextRange: selection is a control selection")}if(0<this.rangeCount)return h.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw c.createError("getNativeTextRange: selection contains no range")}),re.getName=function(){return"WrappedSelection"},re.inspect=function(){return N(this)},re.detach=function(){b(this.win,"delete"),w(this)},v.detachAll=function(){b(null,"deleteAll")},v.inspect=N,v.isDirectionBackward=r,h.Selection=v,h.selectionPrototype=re,h.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})}),A;f("No document found")}else f("No window found")},this),function(e,t){"function"==typeof define&&define.amd?define(["rangy"],e):e(t.rangy)}(function(e){e.createModule("SaveRestore",["WrappedRange"],function(s,a){function l(e,t){return(t||document).getElementById(e)}function i(e,t){var n,o="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),r=p.getDocument(e.startContainer),i=e.cloneRange();return i.collapse(t),(n=r.createElement("span")).id=o,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(r.createTextNode(g)),i.insertNode(n),n}function c(e,t,n,o){var r=l(n,e);r?(t[o?"setStartBefore":"setEndBefore"](r),r.parentNode.removeChild(r)):a.warn("Marker element has been removed. Cannot restore selection.")}function d(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function u(e,t){var n,o=s.DomRange.getRangeDocument(e),r=e.toString();return e.collapsed?{document:o,markerId:(n=i(e,!1)).id,collapsed:!0}:(n=i(e,!1),{document:o,startMarkerId:i(e,!0).id,endMarkerId:n.id,collapsed:!1,backward:t,toString:function(){return"original text: '"+r+"', new text: '"+e.toString()+"'"}})}function o(e,t){var n=e.document;void 0===t&&(t=!0);var o=s.createRange(n);if(e.collapsed){var r=l(e.markerId,n);if(r){r.style.display="inline";var i=r.previousSibling;i&&3==i.nodeType?(r.parentNode.removeChild(r),o.collapseToPoint(i,i.length)):(o.collapseBefore(r),r.parentNode.removeChild(r))}else a.warn("Marker element has been removed. Cannot restore selection.")}else c(n,o,e.startMarkerId,!0),c(n,o,e.endMarkerId,!1);return t&&o.normalizeBoundaries(),o}function h(e,t){var n,o,r=[];(e=e.slice(0)).sort(d);for(var i=0,a=e.length;i<a;++i)r[i]=u(e[i],t);for(i=a-1;0<=i;--i)n=e[i],o=s.DomRange.getRangeDocument(n),n.collapsed?n.collapseAfter(l(r[i].markerId,o)):(n.setEndBefore(l(r[i].endMarkerId,o)),n.setStartAfter(l(r[i].startMarkerId,o)));return r}function e(e){if(!s.isSelectionValid(e))return a.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var t=s.getSelection(e),n=t.getAllRanges(),o=1==n.length&&t.isBackward(),r=h(n,o);return o?t.setSingleRange(n[0],"backward"):t.setRanges(n),{win:e,rangeInfos:r,restored:!1}}function f(e){for(var t=[],n=e.length-1;0<=n;n--)t[n]=o(e[n],!0);return t}function t(e,t){if(!e.restored){var n=e.rangeInfos,o=s.getSelection(e.win),r=f(n);1==n.length&&t&&s.features.selectionHasExtend&&n[0].backward?(o.removeAllRanges(),o.addRange(r[0],!0)):o.setRanges(r),e.restored=!0}}function m(e,t){var n=l(t,e);n&&n.parentNode.removeChild(n)}function n(e){for(var t,n=e.rangeInfos,o=0,r=n.length;o<r;++o)(t=n[o]).collapsed?m(e.doc,t.markerId):(m(e.doc,t.startMarkerId),m(e.doc,t.endMarkerId))}var p=s.dom,g="\ufeff";s.util.extend(s,{saveRange:u,restoreRange:o,saveRanges:h,restoreRanges:f,saveSelection:e,restoreSelection:t,removeMarkerElement:m,removeMarkers:n})})},this);var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var o=new this;n.call(o,e),o.base=function(){},delete Base._prototyping;var r=o.constructor,i=o.constructor=function(e){if(!Base._prototyping)if(this._constructing||this.constructor==i)this._constructing=!0,r.apply(this,arguments),delete this._constructing;else if(null!=e)return(e.extend||n).call(e,o)};return i.ancestor=this,i.extend=this.extend,i.forEach=this.forEach,i.implement=this.implement,i.prototype=o,i.toString=this.toString,i.valueOf=function(e){return"object"==e?i:r.valueOf()},n.call(i,t),"function"==typeof i.init&&i.init(),i},Base.prototype={extend:function(e,t){if(1<arguments.length){var n=this[e];if(n&&"function"==typeof t&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var o=t.valueOf();(t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=o.apply(this,arguments);return this.base=e,t}).valueOf=function(e){return"object"==e?t:o},t.toString=Base.toString}this[e]=t}else if(e){var r=Base.prototype.extend;Base._prototyping||"function"==typeof this||(r=this.extend||r);for(var i={toSource:null},a=["constructor","toString","valueOf"],s=Base._prototyping?0:1;l=a[s++];)e[l]!=i[l]&&r.call(this,l,e[l]);for(var l in e)i[l]||r.call(this,l,e[l])}return this}},Base=Base.extend({constructor:function(e){this.extend(e)}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var o in e)this.prototype[o]===undefined&&t.call(n,e[o],o,e)},implement:function(){for(var e=0;e<arguments.length;e++)"function"==typeof arguments[e]?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),wysihtml5.browser=function(){function i(e){return+(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[undefined,0])[1]}function a(e){return+(e.match(/android (\d+)/)||[undefined,0])[1]}function t(e,t){var n,o=-1;return"Microsoft Internet Explorer"==navigator.appName?n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"):"Netscape"==navigator.appName&&(n=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")),n&&null!=n.exec(navigator.userAgent)&&(o=parseFloat(RegExp.$1)),-1!==o&&(!e||(t?"<"===t?e<o:">"===t?o<e:"<="===t?e<=o:">="===t?o<=e:void 0:e===o))}var r,s,n=navigator.userAgent,l=document.createElement("div"),e=-1!==n.indexOf("Gecko")&&-1===n.indexOf("KHTML"),o=-1!==n.indexOf("AppleWebKit/"),c=-1!==n.indexOf("Chrome/"),d=-1!==n.indexOf("Opera/");return{USER_AGENT:n,supported:function(){var e=this.USER_AGENT.toLowerCase(),t="contentEditable"in l,n=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,o=document.querySelector&&document.querySelectorAll,r=this.isIos()&&i(e)<5||this.isAndroid()&&a(e)<4||-1!==e.indexOf("opera mobi")||-1!==e.indexOf("hpwos/");return t&&n&&o&&!r},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return t()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return t()},hasCurrentStyleProperty:function(){return"currentStyle"in l},hasHistoryIssue:function(){return e&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return e},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in l||(l.setAttribute("on"+e,"return;"),"function"==typeof l["on"+e])},supportsEventsInIframeCorrectly:function(){return!d},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";return t.innerHTML=n,t.innerHTML.toLowerCase()===n},supportsCommand:(r={formatBlock:t(10,"<="),insertUnorderedList:t(),insertOrderedList:t()},s={insertHTML:e},function(e,t){if(!r[t]){try{return e.queryCommandSupported(t)}catch(n){}try{return e.queryCommandEnabled(t)}catch(o){return!!s[t]}}return!1}),doesAutoLinkingInContentEditable:function(){return t()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return e||d||o},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return e||t()||d},autoScrollsToCaret:function(){return!o},autoClosesUnclosedTags:function(){var e,t,n=l.cloneNode(!1);return n.innerHTML="<p><div></div>",t=n.innerHTML.toLowerCase(),e="<p></p><div></div>"===t||"<p><div></div></p>"===t,this.autoClosesUnclosedTags=function(){return e},e},supportsNativeGetElementsByClassName:function(){return-1!==String(document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return d},supportsSpeechApiOn:function(e){return 11<=(n.match(/Chrome\/(\d+)/)||[undefined,0])[1]&&("onwebkitspeechchange"in e||"speech"in e)},crashesWhenDefineProperty:function(e){return t(9)&&("XMLHttpRequest"===e||"XDomainRequest"===e)},doesAsyncFocus:function(){return t()},hasProblemsSettingCaretAfterImg:function(){return t()},hasUndoInContextMenu:function(){return e||c||d},hasInsertNodeIssue:function(){return d},hasIframeFocusIssue:function(){return t()},createsNestedInvalidMarkupAfterPaste:function(){return o},supportsMutationEvents:function(){return"MutationEvent"in window}}}(),wysihtml5.lang.array=function(i){return{contains:function(e){if(Array.isArray(e)){for(var t=e.length;t--;)if(-1!==wysihtml5.lang.array(i).indexOf(e[t]))return!0;return!1}return-1!==wysihtml5.lang.array(i).indexOf(e)},indexOf:function(e){if(i.indexOf)return i.indexOf(e);for(var t=0,n=i.length;t<n;t++)if(i[t]===e)return t;return-1},without:function(e){e=wysihtml5.lang.array(e);for(var t=[],n=0,o=i.length;n<o;n++)e.contains(i[n])||t.push(i[n]);return t},get:function(){for(var e=0,t=i.length,n=[];e<t;e++)n.push(i[e]);return n},map:function(e,t){if(Array.prototype.map)return i.map(e,t);for(var n=i.length>>>0,o=new Array(n),r=0;r<n;r++)o[r]=e.call(t,i[r],r,i);return o},unique:function(){for(var e=[],t=i.length,n=0;n<t;)wysihtml5.lang.array(e).contains(i[n])||e.push(i[n]),n++;return e}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(e,t){return this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t),this},off:function(e,t){this.events=this.events||{};var n,o,r=0;if(e){for(n=this.events[e]||[],o=[];r<n.length;r++)n[r]!==t&&t&&o.push(n[r]);this.events[e]=o}else this.events={};return this},fire:function(e,t){this.events=this.events||{};for(var n=this.events[e]||[],o=0;o<n.length;o++)n[o].call(this,t);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(n){return{merge:function(e){for(var t in e)n[t]=e[t];return this},get:function(){return n},clone:function(){var e,t={};for(e in n)t[e]=n[e];return t},isArray:function(){return"[object Array]"===Object.prototype.toString.call(n)}}},function(){var e=/^\s+/,t=/\s+$/,o=/[&<>"]/g,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};wysihtml5.lang.string=function(n){return n=String(n),{trim:function(){return n.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e)n=this.replace("#{"+t+"}").by(e[t]);return n},replace:function(t){return{by:function(e){return n.split(t).join(e)}}},escapeHTML:function(){return n.replace(o,function(e){return r[e]})}}}}(),function(i){function e(e,t){return n(e,t)?e:(e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body),l(e,t))}function r(e){return e.replace(d,function(e,t){var n=(t.match(u)||[])[1]||"",o=f[n];(t=t.replace(u,"")).split(o).length>t.split(n).length&&(t+=n,n="");var r=t,i=t;return t.length>h&&(i=i.substr(0,h)+"..."),"www."===r.substr(0,4)&&(r="http://"+r),'<a href="'+r+'">'+i+"</a>"+n})}function a(e){var t=e._wysihtml5_tempElement;return t||(t=e._wysihtml5_tempElement=e.createElement("div")),t}function s(e){var t=e.parentNode,n=i.lang.string(e.data).escapeHTML(),o=a(t.ownerDocument);for(o.innerHTML="<span></span>"+r(n),o.removeChild(o.firstChild);o.firstChild;)t.insertBefore(o.firstChild,e);t.removeChild(e)}function n(e,t){for(var n;e.parentNode;){if(n=(e=e.parentNode).nodeName,e.className&&i.lang.array(e.className.split(" ")).contains(t))return!0;if(c.contains(n))return!0;if("body"===n)return!1}return!1}function l(e,t){if(!(c.contains(e.nodeName)||e.className&&i.lang.array(e.className.split(" ")).contains(t))){if(e.nodeType!==i.TEXT_NODE||!e.data.match(d)){for(var n=i.lang.array(e.childNodes).get(),o=n.length,r=0;r<o;r++)l(n[r],t);return e}s(e)}}var c=i.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),d=/((https?:\/\/|www\.)[^\s<]{3,})/gi,u=/([^\w\/\-](,?))$/i,h=100,f={")":"(","]":"[","}":"{"};i.dom.autoLink=e,i.dom.autoLink.URL_REG_EXP=d}(wysihtml5),function(){var o=wysihtml5.dom;o.addClass=function(e,t){var n=e.classList;if(n)return n.add(t);o.hasClass(e,t)||(e.className+=" "+t)},o.removeClass=function(e,t){var n=e.classList;if(n)return n.remove(t);e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ")},o.hasClass=function(e,t){var n=e.classList;if(n)return n.contains(t);var o=e.className;return 0<o.length&&(o==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(o))}}(),wysihtml5.dom.contains=function(){var e=document.documentElement;return e.contains?function(e,t){return t.nodeType!==wysihtml5.ELEMENT_NODE&&(t=t.parentNode),e!==t&&e.contains(t)}:e.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:void 0}(),wysihtml5.dom.convertToList=function(){function g(e,t){var n=e.createElement("li");return t.appendChild(n),n}function y(e,t){return e.createElement(t)}function e(e,t,n){if("UL"===e.nodeName||"OL"===e.nodeName||"MENU"===e.nodeName)return e;var o,r,i,a,s,l,c,d,u,h=e.ownerDocument,f=y(h,t),m=e.querySelectorAll("br"),p=m.length;for(u=0;u<p;u++)for(a=m[u];(s=a.parentNode)&&s!==e&&s.lastChild===a;){if("block"===wysihtml5.dom.getStyle("display").from(s)){s.removeChild(a);break}wysihtml5.dom.insert(a).after(a.parentNode)}for(r=(o=wysihtml5.lang.array(e.childNodes).get()).length,u=0;u<r;u++)d=d||g(h,f),i=o[u],l="block"===wysihtml5.dom.getStyle("display").from(i),c="BR"===i.nodeName,!l||n&&wysihtml5.dom.hasClass(i,n)?c?d=d.firstChild?null:d:d.appendChild(i):((d=d.firstChild?g(h,f):d).appendChild(i),d=null);return 0===o.length&&g(h,f),e.parentNode.replaceChild(f,e),f}return e}(),wysihtml5.dom.copyAttributes=function(i){return{from:function(r){return{to:function(e){for(var t,n=0,o=i.length;n<o;n++)t=i[n],"undefined"!=typeof r[t]&&""!==r[t]&&(e[t]=r[t]);return{andTo:arguments.callee}}}}}},function(a){var s=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],l=function(e){return!!t(e)&&parseInt(a.getStyle("width").from(e),10)<e.offsetWidth},t=function(e){for(var t=0,n=s.length;t<n;t++)if("border-box"===a.getStyle(s[t]).from(e))return s[t]};a.copyStyles=function(i){return{from:function(e){l(e)&&(i=wysihtml5.lang.array(i).without(s));for(var t,n="",o=i.length,r=0;r<o;r++)t=i[r],n+=t+":"+a.getStyle(t).from(e)+";";return{to:function(e){return a.setStyles(n).on(e),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(a){a.dom.delegate=function(o,r,e,i){return a.dom.observe(o,e,function(e){for(var t=e.target,n=a.lang.array(o.querySelectorAll(r));t&&t!==o;){if(n.contains(t)){i.call(t,e);break}t=t.parentNode}})}}(wysihtml5),function(a){a.dom.domNode=function(o){var r=[a.ELEMENT_NODE,a.TEXT_NODE],i=function(e){return e.nodeType===a.TEXT_NODE&&/^\s*$/g.test(e.data)};return{prev:function(e){var t=o.previousSibling,n=e&&e.nodeTypes?e.nodeTypes:r;return t?!a.lang.array(n).contains(t.nodeType)||e&&e.ignoreBlankTexts&&i(t)?a.dom.domNode(t).prev(e):t:null},next:function(e){var t=o.nextSibling,n=e&&e.nodeTypes?e.nodeTypes:r;return t?!a.lang.array(n).contains(t.nodeType)||e&&e.ignoreBlankTexts&&i(t)?a.dom.domNode(t).next(e):t:null}}}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var o=function(e,t){var n=t.createElement("div");n.style.display="none",t.body.appendChild(n);try{n.innerHTML=e}catch(o){}return t.body.removeChild(n),n},r=function(e){if(!e._wysihtml5_supportsHTML5Tags){for(var t=0,n=i.length;t<n;t++)e.createElement(i[t]);e._wysihtml5_supportsHTML5Tags=!0}},i=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(e,t){var n;return t=t||document,"object"==typeof e&&e.nodeType?(n=t.createElement("div")).appendChild(e):wysihtml5.browser.supportsHTML5Tags(t)?(n=t.createElement("div")).innerHTML=e:(r(t),n=o(e,t)),n}}(),wysihtml5.dom.getParentElement=function(){function a(e,t){return!t||!t.length||("string"==typeof t?e===t:wysihtml5.lang.array(t).contains(e))}function s(e){return e.nodeType===wysihtml5.ELEMENT_NODE}function l(e,t,n){var o=(e.className||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}function c(e,t,n){var o=(e.getAttribute("style")||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}return function(e,t,n,o){var r=t.cssStyle||t.styleRegExp,i=t.className||t.classRegExp;for(n=n||50;n--&&e&&"BODY"!==e.nodeName&&(!o||e!==o);){if(s(e)&&a(e.nodeName,t.nodeName)&&(!r||c(e,t.cssStyle,t.styleRegExp))&&(!i||l(e,t.className,t.classRegExp)))return e;e=e.parentNode}return null}}(),wysihtml5.dom.getStyle=function(){function h(e){return e.replace(t,function(e){return e.charAt(1).toUpperCase()})}var f={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},t=/\-[a-z]/g;return function(u){return{from:function(e){if(e.nodeType===wysihtml5.ELEMENT_NODE){var t=e.ownerDocument,n=f[u]||h(u),o=e.style,r=e.currentStyle,i=o[n];if(i)return i;if(r)try{return r[n]}catch(d){}var a,s,l=t.defaultView||t.parentWindow,c=("height"===u||"width"===u)&&"TEXTAREA"===e.nodeName;return l.getComputedStyle?(c&&(a=o.overflow,o.overflow="hidden"),s=l.getComputedStyle(e,null).getPropertyValue(u),c&&(o.overflow=a||""),s):void 0}}}}}(),wysihtml5.dom.getTextNodes=function(e,t){var n=[];for(e=e.firstChild;e;e=e.nextSibling)3==e.nodeType?t&&/^\s*$/.test(e.innerText||e.textContent)||n.push(e):n=n.concat(wysihtml5.dom.getTextNodes(e,t));return n},wysihtml5.dom.hasElementWithTagName=function(){function r(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=t++)}var i={},t=1;return function(e,t){var n=r(e)+":"+t,o=i[n];return o||(o=i[n]=e.getElementsByTagName(t)),0<o.length}}(),function(r){function i(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=t++)}var a={},t=1;r.dom.hasElementWithClassName=function(e,t){if(!r.browser.supportsNativeGetElementsByClassName())return!!e.querySelector("."+t);var n=i(e)+":"+t,o=a[n];return o||(o=a[n]=e.getElementsByClassName(t)),0<o.length}}(wysihtml5),wysihtml5.dom.insert=function(t){return{after:function(e){e.parentNode.insertBefore(t,e.nextSibling)},before:function(e){e.parentNode.insertBefore(t,e)},into:function(e){e.appendChild(t)}}},wysihtml5.dom.insertCSS=function(r){return r=r.join("\n"),{into:function(e){var t=e.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=r:t.appendChild(e.createTextNode(r));var n=e.querySelector("head link");if(n)n.parentNode.insertBefore(t,n);else{var o=e.querySelector("head");o&&o.appendChild(t)}}}},function(i){i.dom.lineBreaks=function(o){function n(e){return"BR"===e.nodeName}function r(e){return!!n(e)||"block"===i.dom.getStyle("display").from(e)}return{add:function(){var e=o.ownerDocument,t=i.dom.domNode(o).next({ignoreBlankTexts:!0}),n=i.dom.domNode(o).prev({ignoreBlankTexts:!0});t&&!r(t)&&i.dom.insert(e.createElement("br")).after(o),n&&!r(n)&&i.dom.insert(e.createElement("br")).before(o)
},remove:function(){var e=i.dom.domNode(o).next({ignoreBlankTexts:!0}),t=i.dom.domNode(o).prev({ignoreBlankTexts:!0});e&&n(e)&&e.parentNode.removeChild(e),t&&n(t)&&t.parentNode.removeChild(t)}}}}(wysihtml5),wysihtml5.dom.observe=function(o,r,i){for(var a,e,t=0,n=(r="string"==typeof r?[r]:r).length;t<n;t++)e=r[t],o.addEventListener?o.addEventListener(e,i,!1):(a=function(e){"target"in e||(e.target=e.srcElement),e.preventDefault=e.preventDefault||function(){this.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=!0},i.call(o,e)},o.attachEvent("on"+e,a));return{stop:function(){for(var e,t=0,n=r.length;t<n;t++)e=r[t],o.removeEventListener?o.removeEventListener(e,i,!1):o.detachEvent("on"+e,a)}}},wysihtml5.dom.parse=function(){function e(e,t){wysihtml5.lang.object(R).merge(T).merge(t.rules).get();var n,o,r,i=t.context||e.ownerDocument||document,a=i.createDocumentFragment(),s="string"==typeof e,l=!1;for(!0===t.clearInternals&&(l=!0),t.uneditableClass&&(_=t.uneditableClass),n=s?wysihtml5.dom.getAsDom(e,i):e;n.firstChild;)(o=u(r=n.firstChild,t.cleanUp,l))&&a.appendChild(o),r!==o&&n.removeChild(r);return n.innerHTML="",n.appendChild(a),s?wysihtml5.quirks.getCorrectInnerHTML(n):n}function u(e,t,n){var o,r,i,a=e.nodeType,s=e.childNodes,l=s.length,c=x[a],d=0;if(_&&1===a&&wysihtml5.dom.hasClass(e,_))return e;if(!(r=c&&c(e,n))){if(!1===r){for(o=e.ownerDocument.createDocumentFragment(),d=l;d--;)s[d]&&(i=u(s[d],t,n))&&(s[d]===i&&d--,o.insertBefore(i,o.firstChild));return wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(e.nodeName.toLowerCase())&&e.parentNode.lastChild!==e&&(e.nextSibling&&3===e.nextSibling.nodeType&&/^\s/.test(e.nextSibling.nodeValue)||o.appendChild(e.ownerDocument.createTextNode(" "))),o.normalize&&o.normalize(),o}return null}for(d=0;d<l;d++)s[d]&&(i=u(s[d],t,n))&&(s[d]===i&&d--,r.appendChild(i));if(t&&r.nodeName.toLowerCase()===N&&(!r.childNodes.length||/^\s*$/gi.test(r.innerHTML)&&(n||"_wysihtml5-temp-placeholder"!==e.className&&"rangySelectionBoundary"!==e.className)||!r.attributes.length)){for(o=r.ownerDocument.createDocumentFragment();r.firstChild;)o.appendChild(r.firstChild);return o.normalize&&o.normalize(),o}return r.normalize&&r.normalize(),r}function t(e,t){var n,o,r=R.tags,i=e.nodeName.toLowerCase(),a=e.scopeName;if(e._wysihtml5)return null;if(e._wysihtml5=1,"wysihtml5-temp"===e.className)return null;if(a&&"HTML"!=a&&(i=a+":"+i),"outerHTML"in e&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==e.nodeName||"</p>"===e.outerHTML.slice(-4).toLowerCase()||(i="div")),i in r){if(!(n=r[i])||n.remove)return null;if(n.unwrap)return!1;n="string"==typeof n?{rename_tag:n}:n}else{if(!e.firstChild)return null;n={rename_tag:N}}return c(e,o=e.ownerDocument.createElement(n.rename_tag||i),n,t),l(e,o,n),n.one_of_type&&!s(e,R,n.one_of_type,t)?(!n.remove_action||"unwrap"!=n.remove_action)&&null:(e=null,o.normalize&&o.normalize(),o)}function s(e,t,n,o){var r;if("SPAN"===e.nodeName&&!o&&("_wysihtml5-temp-placeholder"===e.className||"rangySelectionBoundary"===e.className))return!0;for(r in n)if(n.hasOwnProperty(r)&&t.type_definitions&&t.type_definitions[r]&&i(e,t.type_definitions[r]))return!0;return!1}function i(e,t){var n,o,r,i,a,s=e.getAttribute("class"),l=e.getAttribute("style");if(t.methods)for(var c in t.methods)if(t.methods.hasOwnProperty(c)&&D[c]&&D[c](e))return!0;if(s&&t.classes){n=(s=s.replace(/^\s+/g,"").replace(/\s+$/g,"").split(S)).length;for(var d=0;d<n;d++)if(t.classes[s[d]])return!0}if(l&&t.styles)for(o in l=l.split(";"),t.styles)if(t.styles.hasOwnProperty(o))for(var u=l.length;u--;)if((a=l[u].split(":"))[0].replace(/\s/g,"").toLowerCase()===o&&(!0===t.styles[o]||1===t.styles[o]||wysihtml5.lang.array(t.styles[o]).contains(a[1].replace(/\s/g,"").toLowerCase())))return!0;if(t.attrs)for(r in t.attrs)if(t.attrs.hasOwnProperty(r)&&"string"==typeof(i=E(e,r))&&-1<i.search(t.attrs[r]))return!0;return!1}function l(e,t,n){var o;if(n&&n.keep_styles)for(o in n.keep_styles)n.keep_styles.hasOwnProperty(o)&&("float"==o?(e.style.styleFloat&&(t.style.styleFloat=e.style.styleFloat),e.style.cssFloat&&(t.style.cssFloat=e.style.cssFloat)):e.style[o]&&(t.style[o]=e.style[o]))}function c(e,t,n,o){var r,i,a,s,l,c,d,u={},h=n.set_class,f=n.add_class,m=n.add_style,p=n.set_attributes,g=n.check_attributes,y=R.classes,v=0,w=[],b=[],C=[],x=[];if(p&&(u=wysihtml5.lang.object(p).clone()),g)for(s in g)(c=I[g[s]])&&((d=E(e,s))||"alt"===s&&"IMG"==e.nodeName)&&"string"==typeof(l=c(d))&&(u[s]=l);if(h&&w.push(h),f)for(s in f)(c=L[f[s]])&&"string"==typeof(a=c(E(e,s)))&&w.push(a);if(m)for(s in m)(c=k[m[s]])&&(newStyle=c(E(e,s)),"string"==typeof newStyle&&b.push(newStyle));if("string"==typeof y&&"any"===y&&e.getAttribute("class"))u["class"]=e.getAttribute("class");else{for(o||(y["_wysihtml5-temp-placeholder"]=1,y._rangySelectionBoundary=1,y["wysiwyg-tmp-selected-cell"]=1),(x=e.getAttribute("class"))&&(w=w.concat(x.split(S))),r=w.length;v<r;v++)y[i=w[v]]&&C.push(i);C.length&&(u["class"]=wysihtml5.lang.array(C).unique().join(" "))}for(s in u["class"]&&o&&(u["class"]=u["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(u["class"])&&delete u["class"]),b.length&&(u.style=wysihtml5.lang.array(b).unique().join(" ")),u)try{t.setAttribute(s,u[s])}catch(N){}u.src&&("undefined"!=typeof u.width&&t.setAttribute("width",u.width),"undefined"!=typeof u.height&&t.setAttribute("height",u.height))}function E(e,t){return t=t.toLowerCase(),"IMG"==e.nodeName&&"src"==t&&!0===n(e)?e.src:A&&"outerHTML"in e?-1!=e.outerHTML.toLowerCase().indexOf(" "+t+"=")?e.getAttribute(t):null:e.getAttribute(t)}function n(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&"complete"===e.readyState)return!0}}function o(e){var t=e.nextSibling;if(!t||t.nodeType!==wysihtml5.TEXT_NODE){var n=e.data.replace(O,"");return e.ownerDocument.createTextNode(n)}t.data=e.data.replace(O,"")+t.data.replace(O,"")}function r(e){if(R.comments)return e.ownerDocument.createComment(e.nodeValue)}var a,d,h,f,m,p,g,y,v,w,b,C,x={1:t,3:o,8:r},N="span",S=/\s+/,T={tags:{},classes:{}},R={},_=!1,A=!wysihtml5.browser.supportsGetAttributeCorrectly(),O=/\uFEFF/g,I={url:(m=/^https?:\/\//i,function(e){return e&&e.match(m)?e.replace(m,function(e){return e.toLowerCase()}):null}),src:(f=/^(\/|https?:\/\/)/i,function(e){return e&&e.match(f)?e.replace(f,function(e){return e.toLowerCase()}):null}),href:(h=/^(#|\/|https?:\/\/|mailto:)/i,function(e){return e&&e.match(h)?e.replace(h,function(e){return e.toLowerCase()}):null}),alt:(d=/[^ a-z0-9_\-]/gi,function(e){return e?e.replace(d,""):""}),numbers:(a=/\D/g,function(e){return(e=(e||"").replace(a,""))||null}),any:function(e){return e}},k={align_text:(p={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"},function(e){return p[String(e).toLowerCase()]})},L={align_img:(w={left:"wysiwyg-float-left",right:"wysiwyg-float-right"},function(e){return w[String(e).toLowerCase()]}),align_text:(v={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"},function(e){return v[String(e).toLowerCase()]}),clear_br:(y={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"},function(e){return y[String(e).toLowerCase()]}),size_font:(g={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"},function(e){return g[String(e).charAt(0)]})},D={has_visible_contet:(C=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"],function(e){if((b=(e.innerText||e.textContent).replace(/\s/g,""))&&0<b.length)return!0;for(var t=C.length;t--;)if(e.querySelector(C[t]))return!0;return!!(e.offsetWidth&&0<e.offsetWidth&&e.offsetHeight&&0<e.offsetHeight)})};return e}(),wysihtml5.dom.removeEmptyTextNodes=function(e){for(var t,n=wysihtml5.lang.array(e.childNodes).get(),o=n.length,r=0;r<o;r++)(t=n[r]).nodeType===wysihtml5.TEXT_NODE&&""===t.data&&t.parentNode.removeChild(t)},wysihtml5.dom.renameElement=function(e,t){for(var n,o=e.ownerDocument.createElement(t);n=e.firstChild;)o.appendChild(n);return wysihtml5.dom.copyAttributes(["align","className"]).from(e).to(o),e.parentNode.replaceChild(o,e),o},wysihtml5.dom.replaceWithChildNodes=function(e){if(e.parentNode)if(e.firstChild){for(var t=e.ownerDocument.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e),e=t=null}else e.parentNode.removeChild(e)},function(t){function d(e){return"block"===t.getStyle("display").from(e)}function u(e){return"BR"===e.nodeName}function h(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function e(e,t){if(e.nodeName.match(/^(MENU|UL|OL)$/)){var n,o,r,i,a,s=e.ownerDocument,l=s.createDocumentFragment(),c=wysihtml5.dom.domNode(e).prev({ignoreBlankTexts:!0});if(t)for(!c||d(c)||u(c)||h(l);a=e.firstElementChild||e.firstChild;){for(o=a.lastChild;n=a.firstChild;)r=n===o&&!d(n)&&!u(n),l.appendChild(n),r&&h(l);a.parentNode.removeChild(a)}else for(;a=e.firstElementChild||e.firstChild;){if(a.querySelector&&a.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;n=a.firstChild;)l.appendChild(n);else{for(i=s.createElement("p");n=a.firstChild;)i.appendChild(n);l.appendChild(i)}a.parentNode.removeChild(a)}e.parentNode.replaceChild(l,e)}}t.resolveList=e}(wysihtml5.dom),function(l){var c=document,d=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],u=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],h=["referrer","write","open","close"];l.dom.Sandbox=Base.extend({constructor:function(e,t){this.callback=e||l.EMPTY_FUNCTION,this.config=l.lang.object({}).merge(t).get(),this.editableArea=this._createIframe()},insertInto:function(e){"string"==typeof e&&(e=c.getElementById(e)),e.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var e=this,t=c.createElement("iframe");return t.className="wysihtml5-sandbox",l.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(t),l.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(t.src="javascript:'<html></html>'"),t.onload=function(){t.onreadystatechange=t.onload=null,e._onLoadIframe(t)},t.onreadystatechange=function(){/loaded|complete/.test(t.readyState)&&(t.onreadystatechange=t.onload=null,e._onLoadIframe(t))},t},_onLoadIframe:function(e){if(l.dom.contains(c.documentElement,e)){var t=this,n=e.contentWindow,o=e.contentWindow.document,r=c.characterSet||c.charset||"utf-8",i=this._getHtml({charset:r,stylesheets:this.config.stylesheets});if(o.open("text/html","replace"),o.write(i),o.close(),this.getWindow=function(){return e.contentWindow},this.getDocument=function(){return e.contentWindow.document},n.onerror=function(e,t,n){throw new Error("wysihtml5.Sandbox: "+e,t,n)},!l.browser.supportsSandboxedIframes()){var a,s;for(a=0,s=d.length;a<s;a++)this._unset(n,d[a]);for(a=0,s=u.length;a<s;a++)this._unset(n,u[a],l.EMPTY_FUNCTION);for(a=0,s=h.length;a<s;a++)this._unset(o,h[a]);this._unset(o,"cookie","",!0)}this.loaded=!0,setTimeout(function(){t.callback(t)},0)}},_getHtml:function(e){var t,n=e.stylesheets,o="",r=0;if(n="string"==typeof n?[n]:n)for(t=n.length;r<t;r++)o+='<link rel="stylesheet" href="'+n[r]+'">';return e.stylesheets=o,l.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(e)},_unset:function(e,t,n,o){try{e[t]=n}catch(i){}try{e.__defineGetter__(t,function(){return n})}catch(i){}if(o)try{e.__defineSetter__(t,function(){})}catch(i){}if(!l.browser.crashesWhenDefineProperty(t))try{var r={get:function(){return n}};o&&(r.set=function(){}),Object.defineProperty(e,t,r)}catch(i){}}})}(wysihtml5),function(o){var t=document;o.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(e,t,n){this.callback=e||o.EMPTY_FUNCTION,this.config=o.lang.object({}).merge(t).get(),this.element=n?this._bindElement(n):this._createElement()},_createElement:function(){var e=t.createElement("div");return e.className="wysihtml5-sandbox",this._loadElement(e),e},_bindElement:function(e){return e.className=e.className&&""!=e.className?e.className+" wysihtml5-sandbox":"wysihtml5-sandbox",this._loadElement(e,!0),e},_loadElement:function(e,t){var n=this;if(!t){var o=this._getHtml();e.innerHTML=o}this.getWindow=function(){return e.ownerDocument.defaultView},this.getDocument=function(){return e.ownerDocument},this.loaded=!0,setTimeout(function(){n.callback(n)},0)},_getHtml:function(){return""}})}(wysihtml5),function(){var o={className:"class"};wysihtml5.dom.setAttributes=function(n){return{on:function(e){for(var t in n)e.setAttribute(o[t]||t,n[t])}}}}(),wysihtml5.dom.setStyles=function(o){return{on:function(e){var t=e.style;if("string"!=typeof o)for(var n in o)"float"===n?(t.cssFloat=o[n],t.styleFloat=o[n]):t[n]=o[n];else t.cssText+=";"+o}}},function(a){a.simulatePlaceholder=function(e,t,n){var o="placeholder",r=function(){var e=0<t.element.offsetWidth&&0<t.element.offsetHeight;t.hasPlaceholderSet()&&(t.clear(),t.element.focus(),e&&setTimeout(function(){var e=t.selection.getSelection();e.focusNode&&e.anchorNode||t.selection.selectNode(t.element.firstChild||t.element)},0)),t.placeholderSet=!1,a.removeClass(t.element,o)},i=function(){t.isEmpty()&&(t.placeholderSet=!0,t.setValue(n),a.addClass(t.element,o))};e.on("set_placeholder",i).on("unset_placeholder",r).on("focus:composer",r).on("paste:composer",r).on("blur:composer",i),i()}}(wysihtml5.dom),function(e){var t=document.documentElement;"textContent"in t?(e.setTextContent=function(e,t){e.textContent=t},e.getTextContent=function(e){return e.textContent}):"innerText"in t?(e.setTextContent=function(e,t){e.innerText=t},e.getTextContent=function(e){return e.innerText}):(e.setTextContent=function(e,t){e.nodeValue=t},e.getTextContent=function(e){return e.nodeValue})}(wysihtml5.dom),wysihtml5.dom.getAttribute=function(e,t){var n=!wysihtml5.browser.supportsGetAttributeCorrectly();return t=t.toLowerCase(),"IMG"==e.nodeName&&"src"==t&&!0===_isLoadedImage(e)?e.src:n&&"outerHTML"in e?-1!=e.outerHTML.toLowerCase().indexOf(" "+t+"=")?e.getAttribute(t):null:e.getAttribute(t)},function(r){function i(e,t){for(var n,o=[],r=0,i=e.length;r<i;r++)if(n=e[r].querySelectorAll(t))for(var a=n.length;a--;o.unshift(n[a]));return o}function l(e){e.parentNode.removeChild(e)}function u(e,t){e.parentNode.insertBefore(t,e.nextSibling)}function h(e,t){for(var n=e.nextSibling;1!=n.nodeType;)if(n=n.nextSibling,!t||t==n.tagName.toLowerCase())return n;return null}var f=r.dom,m=function(e){this.el=e,this.isColspan=!1,this.isRowspan=!1,this.firstCol=!0,this.lastCol=!0,this.firstRow=!0,this.lastRow=!0,this.isReal=!0,this.spanCollection=[],this.modified=!1},n=function(e,t){e?(this.cell=e,this.table=f.getParentElement(e,{nodeName:["TABLE"]})):t&&(this.table=t,this.cell=this.table.querySelectorAll("th, td")[0])};n.prototype={addSpannedCellToMap:function(e,t,n,o,r,i){for(var a=[],s=n+(i?parseInt(i,10)-1:0),l=o+(r?parseInt(r,10)-1:0),c=n;c<=s;c++){"undefined"==typeof t[c]&&(t[c]=[]);for(var d=o;d<=l;d++)t[c][d]=new m(e),t[c][d].isColspan=r&&1<parseInt(r,10),t[c][d].isRowspan=i&&1<parseInt(i,10),t[c][d].firstCol=d==o,t[c][d].lastCol=d==l,t[c][d].firstRow=c==n,t[c][d].lastRow=c==s,t[c][d].isReal=d==o&&c==n,(t[c][d].spanCollection=a).push(t[c][d])}},setCellAsModified:function(e){if(e.modified=!0,0<e.spanCollection.length)for(var t=0,n=e.spanCollection.length;t<n;t++)e.spanCollection[t].modified=!0},setTableMap:function(){var e,t,n,o,r,i,a,s,l=[],c=this.getTableRows();for(e=0;e<c.length;e++)for(t=c[e],n=this.getRowCells(t),i=0,"undefined"==typeof l[e]&&(l[e]=[]),o=0;o<n.length;o++){for(r=n[o];"undefined"!=typeof l[e][i];)i++;a=f.getAttribute(r,"colspan"),s=f.getAttribute(r,"rowspan"),a||s?(this.addSpannedCellToMap(r,l,e,i,a,s),i+=a?parseInt(a,10):1):(l[e][i]=new m(r),i++)}return this.map=l},getRowCells:function(e){var t=this.table.querySelectorAll("table"),n=t?i(t,"th, td"):[],o=e.querySelectorAll("th, td");return 0<n.length?r.lang.array(o).without(n):o},getTableRows:function(){var e=this.table.querySelectorAll("table"),t=e?i(e,"tr"):[],n=this.table.querySelectorAll("tr");return 0<t.length?r.lang.array(n).without(t):n},getMapIndex:function(e){for(var t=this.map.length,n=this.map&&this.map[0]?this.map[0].length:0,o=0;o<t;o++)for(var r=0;r<n;r++)if(this.map[o][r].el===e)return{row:o,col:r};return!1},getElementAtIndex:function(e){return this.setTableMap(),this.map[e.row]&&this.map[e.row][e.col]&&this.map[e.row][e.col].el?this.map[e.row][e.col].el:null},getMapElsTo:function(e){var t=[];if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var n=this.idx_start;this.idx_start=this.idx_end,this.idx_end=n}if(this.idx_start.col>this.idx_end.col){var o=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=o}if(null!=this.idx_start&&null!=this.idx_end)for(var r=this.idx_start.row,i=this.idx_end.row;r<=i;r++)for(var a=this.idx_start.col,s=this.idx_end.col;a<=s;a++)t.push(this.map[r][a].el);return t},orderSelectionEnds:function(e){if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(e,t,n){for(var o,r=this.table.ownerDocument,i=r.createDocumentFragment(),a=0;a<t;a++){if(o=r.createElement(e),n)for(var s in n)n.hasOwnProperty(s)&&o.setAttribute(s,n[s]);o.appendChild(document.createTextNode("\xa0")),i.appendChild(o)}return i},correctColIndexForUnreals:function(e,t){for(var n=this.map[t],o=-1,r=0;r<e;r++)n[r].isReal&&o++;return o},getLastNewCellOnRow:function(e,t){for(var n,o,r=this.getRowCells(e),i=0,a=r.length;i<a;i++)if(n=r[i],!1===(o=this.getMapIndex(n))||void 0!==t&&o.row!=t)return n;return null},removeEmptyTable:function(){var e=this.table.querySelectorAll("td, th");return(!e||0==e.length)&&(l(this.table),!0)},splitRowToCells:function(e){if(e.isColspan){var t=parseInt(f.getAttribute(e.el,"colspan")||1,10),n=e.el.tagName.toLowerCase();if(1<t){var o=this.createCells(n,t-1);u(e.el,o)}e.el.removeAttribute("colspan")}},getRealRowEl:function(e,t){var n=null,o=null;t=t||this.idx;for(var r=0,i=this.map[t.row].length;r<i;r++)if((o=this.map[t.row][r]).isReal&&(n=f.getParentElement(o.el,{nodeName:["TR"]})))return n;return null===n&&e&&(n=f.getParentElement(this.map[t.row][t.col].el,{nodeName:["TR"]})||null),n},injectRowAt:function(e,t,n,o,r){var i=this.getRealRowEl(!1,{row:e,col:t}),a=this.createCells(o,n);if(i){var s=this.correctColIndexForUnreals(t,e);0<=s?u(this.getRowCells(i)[s],a):i.insertBefore(a,i.firstChild)}else{var l=this.table.ownerDocument.createElement("tr");l.appendChild(a),u(f.getParentElement(r.el,{nodeName:["TR"]}),l)}},canMerge:function(e){if(this.to=e,this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(this.to),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}for(var o=this.idx_start.row,r=this.idx_end.row;o<=r;o++)for(var i=this.idx_start.col,a=this.idx_end.col;i<=a;i++)if(this.map[o][i].isColspan||this.map[o][i].isRowspan)return!1;return!0},decreaseCellSpan:function(e,t){var n=parseInt(f.getAttribute(e.el,t),10)-1;1<=n?e.el.setAttribute(t,n):(e.el.removeAttribute(t),"colspan"==t&&(e.isColspan=!1),"rowspan"==t&&(e.isRowspan=!1),e.firstCol=!0,e.lastCol=!0,e.firstRow=!0,e.lastRow=!0,e.isReal=!0)},removeSurplusLines:function(){var e,t,n,o,r,i,a;if(this.setTableMap(),this.map){for(n=0,o=this.map.length;n<o;n++){for(a=!0,r=0,i=(e=this.map[n]).length;r<i;r++)if(t=e[r],!(f.getAttribute(t.el,"rowspan")&&1<parseInt(f.getAttribute(t.el,"rowspan"),10)&&!0!==t.firstRow)){a=!1;break}if(a)for(r=0;r<i;r++)this.decreaseCellSpan(e[r],"rowspan")}var s=this.getTableRows();for(n=0,o=s.length;n<o;n++)0==(e=s[n]).childNodes.length&&/^\s*$/.test(e.textContent||e.innerText)&&l(e)}},fillMissingCells:function(){var e=0,t=0,n=null;if(this.setTableMap(),this.map){e=this.map.length;for(var o=0;o<e;o++)this.map[o].length>t&&(t=this.map[o].length);for(var r=0;r<e;r++)for(var i=0;i<t;i++)this.map[r]&&!this.map[r][i]&&0<i&&(this.map[r][i]=new m(this.createCells("td",1)),(n=this.map[r][i-1])&&n.el&&n.el.parent&&u(this.map[r][i-1].el,this.map[r][i].el))}},rectify:function(){return!this.removeEmptyTable()&&(this.removeSurplusLines(),this.fillMissingCells(),!0)},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx)){var e=this.map[this.idx.row][this.idx.col],t=f.getAttribute(e.el,"colspan")?parseInt(f.getAttribute(e.el,"colspan"),10):1,n=e.el.tagName.toLowerCase();if(e.isRowspan){var o=parseInt(f.getAttribute(e.el,"rowspan"),10);if(1<o)for(var r=1,i=o-1;r<=i;r++)this.injectRowAt(this.idx.row+r,this.idx.col,t,n,e);e.el.removeAttribute("rowspan")}this.splitRowToCells(e)}},merge:function(e){if(this.rectify())if(this.canMerge(e)){for(var t=this.idx_end.row-this.idx_start.row+1,n=this.idx_end.col-this.idx_start.col+1,o=this.idx_start.row,r=this.idx_end.row;o<=r;o++)for(var i=this.idx_start.col,a=this.idx_end.col;i<=a;i++)o==this.idx_start.row&&i==this.idx_start.col?(1<t&&this.map[o][i].el.setAttribute("rowspan",t),1<n&&this.map[o][i].el.setAttribute("colspan",n)):(/^\s*<br\/?>\s*$/.test(this.map[o][i].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[o][i].el.innerHTML),l(this.map[o][i].el));this.rectify()}else window.console&&console.log("Do not know how to merge allready merged cells.")},collapseCellToNextRow:function(e){var t=this.getMapIndex(e.el),n=t.row+1,o={row:n,col:t.col};if(n<this.map.length){var r=this.getRealRowEl(!1,o);if(null!==r){var i=this.correctColIndexForUnreals(o.col,o.row);if(0<=i)u(this.getRowCells(r)[i],e.el);else{var a=this.getLastNewCellOnRow(r,n);null!==a?u(a,e.el):r.insertBefore(e.el,r.firstChild)}2<parseInt(f.getAttribute(e.el,"rowspan"),10)?e.el.setAttribute("rowspan",parseInt(f.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")}}},removeRowCell:function(e){e.isReal?e.isRowspan?this.collapseCellToNextRow(e):l(e.el):2<parseInt(f.getAttribute(e.el,"rowspan"),10)?e.el.setAttribute("rowspan",parseInt(f.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=this.map[this.idx.row],n=0,o=t.length;n<o;n++)t[n].isReal&&e.push(t[n].el);return e},getColumnElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=0,n=this.map.length;t<n;t++)this.map[t][this.idx.col]&&this.map[t][this.idx.col].isReal&&e.push(this.map[t][this.idx.col].el);return e},removeRow:function(){var e=f.getParentElement(this.cell,{nodeName:["TR"]});if(e){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=this.map[this.idx.row],n=0,o=t.length;n<o;n++)t[n].modified||(this.setCellAsModified(t[n]),this.removeRowCell(t[n]));l(e)}},removeColCell:function(e){e.isColspan?2<parseInt(f.getAttribute(e.el,"colspan"),10)?e.el.setAttribute("colspan",parseInt(f.getAttribute(e.el,"colspan"),10)-1):e.el.removeAttribute("colspan"):e.isReal&&l(e.el)},removeColumn:function(){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var e=0,t=this.map.length;e<t;e++)this.map[e][this.idx.col].modified||(this.setCellAsModified(this.map[e][this.idx.col]),this.removeColCell(this.map[e][this.idx.col]))},remove:function(e){if(this.rectify()){switch(e){case"row":this.removeRow();break;case"column":this.removeColumn()}this.rectify()}},addRow:function(e){var t=this.table.ownerDocument;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"below"==e&&f.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(f.getAttribute(this.cell,"rowspan"),10)-1),!1!==this.idx){for(var n=this.map[this.idx.row],o=t.createElement("tr"),r=0,i=n.length;r<i;r++)n[r].modified||(this.setCellAsModified(n[r]),this.addRowCell(n[r],o,e));switch(e){case"below":u(this.getRealRowEl(!0),o);break;case"above":var a=f.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]});a&&a.parentNode.insertBefore(o,a)}}},addRowCell:function(e,t,n){var o=e.isColspan?{colspan:f.getAttribute(e.el,"colspan")}:null;e.isReal?"above"!=n&&e.isRowspan?e.el.setAttribute("rowspan",parseInt(f.getAttribute(e.el,"rowspan"),10)+1):t.appendChild(this.createCells("td",1,o)):"above"!=n&&e.isRowspan&&e.lastRow?t.appendChild(this.createCells("td",1,o)):c.isRowspan&&e.el.attr("rowspan",parseInt(f.getAttribute(e.el,"rowspan"),10)+1)},add:function(e){this.rectify()&&("below"!=e&&"above"!=e||this.addRow(e),"before"!=e&&"after"!=e||this.addColumn(e))},addColCell:function(e,t,n){var o,r=e.el.tagName.toLowerCase();switch(n){case"before":o=!e.isColspan||e.firstCol;break;case"after":o=!e.isColspan||e.lastCol||e.isColspan&&c.el==this.cell}if(o){switch(n){case"before":e.el.parentNode.insertBefore(this.createCells(r,1),e.el);break;case"after":u(e.el,this.createCells(r,1))}e.isRowspan&&this.handleCellAddWithRowspan(e,t+1,n)}else e.el.setAttribute("colspan",parseInt(f.getAttribute(e.el,"colspan"),10)+1)},addColumn:function(e){var t,n;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"after"==e&&f.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(f.getAttribute(this.cell,"colspan"),10)-1),!1!==this.idx)for(var o=0,r=this.map.length;o<r;o++)(t=this.map[o])[this.idx.col]&&((n=t[this.idx.col]).modified||(this.setCellAsModified(n),this.addColCell(n,o,e)))},handleCellAddWithRowspan:function(e,t,n){for(var o,r,i,a=parseInt(f.getAttribute(this.cell,"rowspan"),10)-1,s=f.getParentElement(e.el,{nodeName:["TR"]}),l=e.el.tagName.toLowerCase(),c=this.table.ownerDocument,d=0;d<a;d++)if(o=this.correctColIndexForUnreals(this.idx.col,t+d),s=h(s,"tr"))if(0<o)switch(n){case"before":r=this.getRowCells(s),0<o&&this.map[t+d][this.idx.col].el!=r[o]&&o==r.length-1?u(r[o],this.createCells(l,1)):r[o].parentNode.insertBefore(this.createCells(l,1),r[o]);break;case"after":u(this.getRowCells(s)[o],this.createCells(l,1))}else s.insertBefore(this.createCells(l,1),s.firstChild);else(i=c.createElement("tr")).appendChild(this.createCells(l,1)),this.table.appendChild(i)}},f.table={getCellsBetween:function(e,t){return new n(e).getMapElsTo(t)},addCells:function(e,t){new n(e).add(t)},removeCells:function(e,t){new n(e).remove(t)},mergeCellsBetween:function(e,t){new n(e).merge(t)},unmergeCell:function(e){new n(e).unmerge()},orderSelectionEnds:function(e,t){return new n(e).orderSelectionEnds(t)},indexOf:function(e){var t=new n(e);return t.setTableMap(),t.getMapIndex(e)},findCell:function(e,t){return new n(null,e).getElementAtIndex(t)},findRowByCell:function(e){return new n(e).getRowElementsByCell()},findColumnByCell:function(e){return new n(e).getColumnElementsByCell()},canMerge:function(e,t){return new n(e).canMerge(t)}}}(wysihtml5),wysihtml5.dom.query=function(e,t){var n,o=[];e.nodeType&&(e=[e]);for(var r=0,i=e.length;r<i;r++)if(n=e[r].querySelectorAll(t))for(var a=n.length;a--;o.unshift(n[a]));return o},wysihtml5.dom.compareDocumentPosition=document.documentElement.compareDocumentPosition?function(e,t){return e.compareDocumentPosition(t)}:function(e,t){var n,o;if(n=9===e.nodeType?e:e.ownerDocument,o=9===t.nodeType?t:t.ownerDocument,e===t)return 0;if(e===t.ownerDocument)return 20;if(e.ownerDocument===t)return 10;if(n!==o)return 1;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml5.lang.array(e.childNodes).indexOf(t))return 20;if(2===t.nodeType&&t.childNodes&&-1!==wysihtml5.lang.array(t.childNodes).indexOf(e))return 10;for(var r=e,i=[],a=null;r;){if(r==t)return 10;i.push(r),r=r.parentNode}for(r=t,a=null;r;){if(r==e)return 20;var s=wysihtml5.lang.array(i).indexOf(r);if(-1!==s){var l=i[s],c=wysihtml5.lang.array(l.childNodes).indexOf(i[s-1]);return wysihtml5.lang.array(l.childNodes).indexOf(a)<c?2:4}r=(a=r).parentNode}return 1},wysihtml5.dom.unwrap=function(e){if(e.parentNode){for(;e.lastChild;)wysihtml5.dom.insert(e.lastChild).after(e);e.parentNode.removeChild(e)}},wysihtml5.quirks.cleanPastedHTML=function(){function e(e,t,n){t=t||h,n=n||e.ownerDocument||document;var o,r,i,a,s,l,c="string"==typeof e,d=0;for(s in o=c?wysihtml5.dom.getAsDom(e,n):e,t)for(i=o.querySelectorAll(s),r=t[s],a=i.length;d<a;d++)r(i[d]);var u=wysihtml5.dom.getTextNodes(o);for(l=u.length;l--;)u[l].nodeValue=u[l].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");return i=e=t=null,c?o.innerHTML:o}var h={"a u":wysihtml5.dom.replaceWithChildNodes};return e}(),wysihtml5.quirks.ensureProperClearing=function(){var t=function(){var t=this;setTimeout(function(){var e=t.innerHTML.toLowerCase();"<p>&nbsp;</p>"!=e&&"<p>&nbsp;</p><p>&nbsp;</p>"!=e||(t.innerHTML="")},0)};return function(e){wysihtml5.dom.observe(e.element,["cut","keydown"],t)}}(),function(s){var l="%7E";s.quirks.getCorrectInnerHTML=function(e){var t=e.innerHTML;if(-1===t.indexOf(l))return t;var n,o,r,i,a=e.querySelectorAll("[href*='~'], [src*='~']");for(i=0,r=a.length;i<r;i++)n=a[i].href||a[i].src,o=s.lang.string(n).replace("~").by(l),t=s.lang.string(t).replace(o).by(n);return t}}(wysihtml5),function(o){var r="wysihtml5-quirks-redraw";o.quirks.redraw=function(e){o.dom.addClass(e,r),o.dom.removeClass(e,r);try{var t=e.ownerDocument;t.execCommand("italic",!1,null),t.execCommand("italic",!1,null)}catch(n){}}}(wysihtml5),wysihtml5.quirks.tableCellsSelection=function(n,r){function e(){return d.observe(n,"mousedown",function(e){var t=wysihtml5.dom.getParentElement(e.target,{nodeName:["TD","TH"]});t&&o(t)}),u}function o(e){u.start=e,u.end=e,u.cells=[e],u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),u.table&&(i(),d.addClass(e,h),f=d.observe(n,"mousemove",t),m=d.observe(n,"mouseup",s),r.fire("tableselectstart").fire("tableselectstart:composer"))}function i(){if(n){var e=n.querySelectorAll("."+h);if(0<e.length)for(var t=0;t<e.length;t++)d.removeClass(e[t],h)}}function a(e){for(var t=0;t<e.length;t++)d.addClass(e[t],h)}function t(e){var t,n=null,o=d.getParentElement(e.target,{nodeName:["TD","TH"]});o&&u.table&&u.start&&(n=d.getParentElement(o,{nodeName:["TABLE"]}))&&n===u.table&&(i(),t=u.end,u.end=o,u.cells=d.table.getCellsBetween(u.start,o),1<u.cells.length&&r.composer.selection.deselect(),a(u.cells),u.end!==t&&r.fire("tableselectchange").fire("tableselectchange:composer"))}function s(){f.stop(),m.stop(),r.fire("tableselect").fire("tableselect:composer"),setTimeout(function(){l()},0)}function l(){var t=d.observe(n.ownerDocument,"click",function(e){t.stop(),d.getParentElement(e.target,{nodeName:["TABLE"]})!=u.table&&(i(),u.table=null,u.start=null,u.end=null,r.fire("tableunselect").fire("tableunselect:composer"))})}function c(e,t){u.start=e,u.end=t,u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),selectedCells=d.table.getCellsBetween(u.start,u.end),a(selectedCells),l(),r.fire("tableselect").fire("tableselect:composer")}var d=wysihtml5.dom,u={table:null,start:null,end:null,cells:null,select:c},h="wysiwyg-tmp-selected-cell",f=null,m=null;return e()},function(l){
var c=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,d=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,u=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,h=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,f=function(e){return new RegExp("(^|\\s|;)"+e+"\\s*:\\s*[^;$]+","gi")};l.quirks.styleParser={parseColor:function(e,t){var n,o,r=f(t),i=e.match(r),a=10;if(i){for(var s=i.length;s--;)i[s]=l.lang.string(i[s].split(":")[1]).trim();if(n=i[i.length-1],c.test(n))o=n.match(c);else if(d.test(n))o=n.match(d);else if(u.test(n))o=n.match(u),a=16;else if(h.test(n))return(o=n.match(h)).shift(),o.push(1),l.lang.array(o).map(function(e,t){return t<3?16*parseInt(e,16)+parseInt(e,16):parseFloat(e)});if(o)return o.shift(),o[3]||o.push(1),l.lang.array(o).map(function(e,t){return t<3?parseInt(e,a):parseFloat(e)})}return!1},unparseColor:function(e,t){if(t){if("hex"==t)return e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("hash"==t)return"#"+e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("rgb"==t)return"rgb("+e[0]+","+e[1]+","+e[2]+")";if("rgba"==t)return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")";if("csv"==t)return e[0]+","+e[1]+","+e[2]+","+e[3]}return e[3]&&1!==e[3]?"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")":"rgb("+e[0]+","+e[1]+","+e[2]+")"},parseFontSize:function(e){var t=e.match(f("font-size"));return!!t&&l.lang.string(t[t.length-1].split(":")[1]).trim()}}}(wysihtml5),function(w){function a(e){var t=0;if(e.parentNode)for(;t+=e.offsetTop||0,e=e.offsetParent;);return t}function r(e,t){for(var n=0;t!==e;)if(n++,!(t=t.parentNode))throw new Error("not a descendant of ancestor!");return n}function t(e){if(!e.canSurroundContents())for(var t=e.commonAncestorContainer,n=r(t,e.startContainer),o=r(t,e.endContainer);!e.canSurroundContents();)o<n?(e.setStartBefore(e.startContainer),n=r(t,e.startContainer)):(e.setEndAfter(e.endContainer),o=r(t,e.endContainer))}var b=w.dom;w.Selection=Base.extend({constructor:function(e,t,n){window.rangy.init(),this.editor=e,this.composer=e.composer,this.doc=this.composer.doc,this.contain=t,this.unselectableClass=n||!1},getBookmark:function(){var e=this.getRange();return e&&t(e),e&&e.cloneRange()},setBookmark:function(e){e&&this.setSelection(e)},setBefore:function(e){var t=rangy.createRange(this.doc);return t.setStartBefore(e),t.setEndBefore(e),this.setSelection(t)},setAfter:function(e){var t=rangy.createRange(this.doc);return t.setStartAfter(e),t.setEndAfter(e),this.setSelection(t)},selectNode:function(e,t){var n=rangy.createRange(this.doc),o=e.nodeType===w.ELEMENT_NODE,r="canHaveHTML"in e?e.canHaveHTML:"IMG"!==e.nodeName,i=o?e.innerHTML:e.data,a=""===i||i===w.INVISIBLE_SPACE,s=b.getStyle("display").from(e),l="block"===s||"list-item"===s;if(a&&o&&r&&!t)try{e.innerHTML=w.INVISIBLE_SPACE}catch(c){}r?n.selectNodeContents(e):n.selectNode(e),r&&a&&o?n.collapse(l):r&&a&&(n.setStartAfter(e),n.setEndAfter(e)),this.setSelection(n)},getSelectedNode:function(e){var t,n;return e&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange())&&n.length?n.item(0):(t=this.getSelection(this.doc)).focusNode===t.anchorNode?t.focusNode:(n=this.getRange(this.doc))?n.commonAncestorContainer:this.doc.body},fixSelBorders:function(){var e=this.getRange();t(e),this.setSelection(e)},getSelectedOwnNodes:function(){for(var e=this.getOwnRanges(),t=[],n=0,o=e.length;n<o;n++)t.push(e[n].commonAncestorContainer||this.doc.body);return t},findNodesInSelection:function(t){for(var e,n=this.getOwnRanges(),o=[],r=0,i=n.length;r<i;r++)e=n[r].getNodes([1],function(e){return w.lang.array(t).contains(e.nodeName)}),o=o.concat(e);return o},containsUneditable:function(){for(var e=this.getOwnUneditables(),t=this.getSelection(),n=0,o=e.length;n<o;n++)if(t.containsNode(e[n]))return!0;return!1},deleteContents:function(){for(var e=this.getOwnRanges(),t=e.length;t--;)e[t].deleteContents();this.setSelection(e[0])},getPreviousNode:function(e,t){e||(e=this.getSelection().anchorNode);if(e===this.contain)return!1;var n,o=e.previousSibling;return o!==this.contain&&(o&&3!==o.nodeType&&1!==o.nodeType?o=this.getPreviousNode(o,t):o&&3===o.nodeType&&/^\s*$/.test(o.textContent)?o=this.getPreviousNode(o,t):t&&o&&1===o.nodeType&&!w.lang.array(["BR","HR","IMG"]).contains(o.nodeName)&&/^[\s]*$/.test(o.innerHTML)?o=this.getPreviousNode(o,t):o||e===this.contain||(n=e.parentNode)!==this.contain&&(o=this.getPreviousNode(n,t)),o!==this.contain&&o)},getSelectionParentsByTag:function(){for(var e,t=this.getSelectedOwnNodes(),n=[],o=0,r=t.length;o<r;o++)(e=t[o].nodeName&&"LI"===t[o].nodeName?t[o]:w.dom.getParentElement(t[o],{nodeName:["LI"]},!1,this.contain))&&n.push(e);return n.length?n:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var e=this.getRange(),t=e.startContainer,n=e.startOffset,o=rangy.createRange(this.doc);return o.selectNodeContents(t),o.setStart(t,n),o}},caretIsLastInSelection:function(){rangy.createRange(this.doc),this.getSelection();var e=this.getRangeToNodeEnd().cloneContents().textContent;return/^\s*$/.test(e)},caretIsFirstInSelection:function(){var e=rangy.createRange(this.doc),t=this.getSelection(),n=this.getRange(),o=n.startContainer;return o.nodeType===w.TEXT_NODE?this.isCollapsed()&&o.nodeType===w.TEXT_NODE&&/^\s*$/.test(o.data.substr(0,n.startOffset)):(e.selectNodeContents(this.getRange().commonAncestorContainer),e.collapse(!0),this.isCollapsed()&&(e.startContainer===t.anchorNode||e.endContainer===t.anchorNode)&&e.startOffset===t.anchorOffset)},caretIsInTheBeginnig:function(e){var t=this.getSelection(),n=t.anchorNode,o=t.anchorOffset;return e?0===o&&(n.nodeName&&n.nodeName===e.toUpperCase()||w.dom.getParentElement(n.parentNode,{nodeName:e},1)):0===o&&!this.getPreviousNode(n,!0)},caretIsBeforeUneditable:function(){var e=this.getSelection(),t=e.anchorNode;if(0===e.anchorOffset){var n=this.getPreviousNode(t,!0);if(n)for(var o=this.getOwnUneditables(),r=0,i=o.length;r<i;r++)if(n===o[r])return o[r]}return!1},executeAndRestoreRangy:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=rangy.saveSelection(t);if(n)try{e()}catch(o){setTimeout(function(){throw o},0)}else e();rangy.restoreSelection(n)},executeAndRestore:function(e,t){var n,o,r,i,a,s,l,c,d=this.doc.body,u=t&&d.scrollTop,h=t&&d.scrollLeft,f="_wysihtml5-temp-placeholder",m='<span class="'+f+'">'+w.INVISIBLE_SPACE+"</span>",p=this.getRange(!0);if(p){p.collapsed||(s=(l=p.cloneRange()).createContextualFragment(m),l.collapse(!1),l.insertNode(s),l.detach()),a=p.createContextualFragment(m),p.insertNode(a),s&&(n=this.contain.querySelectorAll("."+f),p.setStartBefore(n[0]),p.setEndAfter(n[n.length-1])),this.setSelection(p);try{e(p.startContainer,p.endContainer)}catch(y){setTimeout(function(){throw y},0)}if((n=this.contain.querySelectorAll("."+f))&&n.length){c=rangy.createRange(this.doc),r=n[0].nextSibling,1<n.length&&(i=n[n.length-1].previousSibling),i&&r?(c.setStartBefore(r),c.setEndAfter(i)):(o=this.doc.createTextNode(w.INVISIBLE_SPACE),b.insert(o).after(n[0]),c.setStartBefore(o),c.setEndAfter(o)),this.setSelection(c);for(var g=n.length;g--;)n[g].parentNode.removeChild(n[g])}else this.contain.focus();t&&(d.scrollTop=u,d.scrollLeft=h);try{n.parentNode.removeChild(n)}catch(v){}}else e(d,d)},set:function(e,t){var n=rangy.createRange(this.doc);n.setStart(e,t||0),this.setSelection(n)},insertHTML:function(e){var t=rangy.createRange(this.doc).createContextualFragment(e),n=t.lastChild;this.insertNode(t),n&&this.setAfter(n)},insertNode:function(e){var t=this.getRange();t&&t.insertNode(e)},surround:function(e){var t,n=this.getOwnRanges(),o=[];if(0==n.length)return o;for(var r=n.length;r--;){t=this.doc.createElement(e.nodeName),o.push(t),e.className&&(t.className=e.className),e.cssStyle&&t.setAttribute("style",e.cssStyle);try{n[r].surroundContents(t),this.selectNode(t)}catch(i){t.appendChild(n[r].extractContents()),n[r].insertNode(t)}}return o},deblockAndSurround:function(e){var t,n,o,r=this.doc.createElement("div"),i=rangy.createRange(this.doc);if(r.className=e.className,this.composer.commands.exec("formatBlock",e.nodeName,e.className),(t=this.contain.querySelectorAll("."+e.className))[0])for(t[0].parentNode.insertBefore(r,t[0]),i.setStartBefore(t[0]),i.setEndAfter(t[t.length-1]),n=i.extractContents();n.firstChild;)if(1==(o=n.firstChild).nodeType&&w.dom.hasClass(o,e.className)){for(;o.firstChild;)r.appendChild(o.firstChild);"BR"!==o.nodeName&&r.appendChild(this.doc.createElement("br")),n.removeChild(o)}else r.appendChild(o);else r=null;return r},scrollIntoView:function(){var e,t,n=this.doc,o=5,r=n.documentElement.scrollHeight>n.documentElement.offsetHeight,i=n._wysihtml5ScrollIntoViewElement=n._wysihtml5ScrollIntoViewElement||((t=n.createElement("span")).innerHTML=w.INVISIBLE_SPACE,t);r&&(this.insertNode(i),e=a(i),i.parentNode.removeChild(i),e>=n.body.scrollTop+n.documentElement.offsetHeight-o&&(n.body.scrollTop=e))},selectLine:function(){w.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var e=this.doc.defaultView.getSelection();e.modify("move","left","lineboundary"),e.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e,t,n,o,r,i=this.doc.selection.createRange(),a=i.boundingTop,s=this.doc.body.scrollWidth;if(i.moveToPoint){for(0===a&&(n=this.doc.createElement("span"),this.insertNode(n),a=n.offsetTop,n.parentNode.removeChild(n)),a+=1,o=-10;o<s;o+=2)try{i.moveToPoint(o,a);break}catch(l){}for(e=a,t=this.doc.selection.createRange(),r=s;0<=r;r--)try{t.moveToPoint(r,e);break}catch(c){}i.setEndPoint("EndToEnd",t),i.select()}},getText:function(){var e=this.getSelection();return e?e.toString():""},getNodes:function(e,t){var n=this.getRange();return n?n.getNodes([e],t):[]},fixRangeOverflow:function(e){if(this.contain&&this.contain.firstChild&&e){var t=e.compareNode(this.contain);if(2!==t)1===t&&e.setStartBefore(this.contain.firstChild),0===t&&e.setEndAfter(this.contain.lastChild),3===t&&(e.setStartBefore(this.contain.firstChild),e.setEndAfter(this.contain.lastChild));else if(this._detectInlineRangeProblems(e)){var n=e.endContainer.previousElementSibling;n&&e.setEnd(n,this._endOffsetForNode(n))}}},_endOffsetForNode:function(e){var t=document.createRange();return t.selectNodeContents(e),t.endOffset},_detectInlineRangeProblems:function(e){var t=b.compareDocumentPosition(e.startContainer,e.endContainer);return 0==e.endOffset&&4&t},getRange:function(e){var t=this.getSelection(),n=t&&t.rangeCount&&t.getRangeAt(0);return!0!==e&&this.fixRangeOverflow(n),n},getOwnUneditables:function(){var e=b.query(this.contain,"."+this.unselectableClass),t=b.query(e,"."+this.unselectableClass);return w.lang.array(e).without(t)},getOwnRanges:function(){var e,t=[],n=this.getRange();if(n&&t.push(n),this.unselectableClass&&this.contain&&n){var o,r=this.getOwnUneditables();if(0<r.length)for(var i=0,a=r.length;i<a;i++){e=[];for(var s=0,l=t.length;s<l;s++){if(t[s])switch(t[s].compareNode(r[i])){case 2:break;case 3:(o=t[s].cloneRange()).setEndBefore(r[i]),e.push(o),(o=t[s].cloneRange()).setStartAfter(r[i]),e.push(o);break;default:e.push(t[s])}t=e}}}return t},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow;return rangy.getSelection(t).setSingleRange(e)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},isEndToEndInNode:function(e){var t=this.getRange(),n=t.commonAncestorContainer,o=t.startContainer,r=t.endContainer;if(n.nodeType===w.TEXT_NODE&&(n=n.parentNode),o.nodeType===w.TEXT_NODE&&!/^\s*$/.test(o.data.substr(t.startOffset)))return!1;if(r.nodeType===w.TEXT_NODE&&!/^\s*$/.test(r.data.substr(t.endOffset)))return!1;for(;o&&o!==n;){if(o.nodeType!==w.TEXT_NODE&&!w.dom.contains(n,o))return!1;if(w.dom.domNode(o).prev({ignoreBlankTexts:!0}))return!1;o=o.parentNode}for(;r&&r!==n;){if(r.nodeType!==w.TEXT_NODE&&!w.dom.contains(n,r))return!1;if(w.dom.domNode(r).next({ignoreBlankTexts:!0}))return!1;r=r.parentNode}return!!w.lang.array(e).contains(n.nodeName)&&n},deselect:function(){var e=this.getSelection();e&&e.removeAllRanges()}})}(wysihtml5),function(c,a){function n(e,t,n){if(!e.className)return!1;var o=e.className.match(n)||[];return o[o.length-1]===t}function o(e,t){if(!e.getAttribute||!e.getAttribute("style"))return!1;e.getAttribute("style").match(t);return!!e.getAttribute("style").match(t)}function r(e,t,n){e.getAttribute("style")?(s(e,n),e.getAttribute("style")&&!/^\s*$/.test(e.getAttribute("style"))?e.setAttribute("style",t+";"+e.getAttribute("style")):e.setAttribute("style",t)):e.setAttribute("style",t)}function i(e,t,n){e.className?(l(e,n),e.className+=" "+t):e.className=t}function l(e,t){e.className&&(e.className=e.className.replace(t,""))}function s(e,t){var n,o=[];if(e.getAttribute("style")){for(var r=(n=e.getAttribute("style").split(";")).length;r--;)n[r].match(t)||/^\s*$/.test(n[r])||o.push(n[r]);o.length?e.setAttribute("style",o.join(";")):e.removeAttribute("style")}}function d(e,t){var n=[],o=t.split(";"),r=e.getAttribute("style");if(r){r=r.replace(/\s/gi,"").toLowerCase(),n.push(new RegExp("(^|\\s|;)"+t.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var i=o.length;0<i--;)/^\s*$/.test(o[i])||n.push(new RegExp("(^|\\s|;)"+o[i].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var a=0,s=n.length;a<s;a++)if(r.match(n[a]))return n[a]}return!1}function u(e,t,n,o){return n?d(e,n):o?c.dom.hasClass(e,o):a.dom.arrayContains(t,e.tagName.toLowerCase())}function h(e,t,n,o){for(var r=e.length;r--;)if(!u(e[r],t,n,o))return!1;return!!e.length}function f(e,t,n){var o=d(e,t);return o?(s(e,o),"remove"):(r(e,t,n),"change")}function m(e,t){return e.className.replace(C," ")==t.className.replace(C," ")}function p(e){for(var t=e.parentNode;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}function g(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,o,r,i=0,a=e.attributes.length;i<a;++i)if("class"!=(r=(n=e.attributes[i]).name)){if(o=t.attributes.getNamedItem(r),n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function y(e,t){return a.dom.isCharacterDataNode(e)?0==t?!!e.previousSibling:t!=e.length||!!e.nextSibling:0<t&&t<e.childNodes.length}function v(e,t,n,o){var r;if(a.dom.isCharacterDataNode(t)&&(0==n?(n=a.dom.getNodeIndex(t),t=t.parentNode):n==t.length?(n=a.dom.getNodeIndex(t)+1,t=t.parentNode):r=a.dom.splitDataNode(t,n)),!(r||o&&t===o)){var i;for((r=t.cloneNode(!1)).id&&r.removeAttribute("id");i=t.childNodes[n];)r.appendChild(i);a.dom.insertAfter(r,t)}return t==e?r:v(e,r.parentNode,a.dom.getNodeIndex(r),o)}function w(e){this.isElementMerge=e.nodeType==c.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?e.lastChild:e,this.textNodes=[this.firstTextNode]}function e(e,t,n,o,r,i,a){this.tagNames=e||[b],this.cssClass=t||!1!==t&&"",this.similarClassRegExp=n,this.cssStyle=r||"",this.similarStyleRegExp=i,this.normalize=o,this.applyToAnyTagName=!1,this.container=a}var b="span",C=/\s+/g;w.prototype={doMerge:function(){for(var e,t,n,o=[],r=0,i=this.textNodes.length;r<i;++r)t=(e=this.textNodes[r]).parentNode,o[r]=e.data,r&&(t.removeChild(e),t.hasChildNodes()||t.parentNode.removeChild(t));return this.firstTextNode.data=n=o.join(""),n},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}},e.prototype={getAncestorWithClass:function(e){for(var t;e;){if(t=this.cssClass?n(e,this.cssClass,this.similarClassRegExp):""===this.cssStyle,e.nodeType==c.ELEMENT_NODE&&"false"!=e.getAttribute("contenteditable")&&a.dom.arrayContains(this.tagNames,e.tagName.toLowerCase())&&t)return e;e=e.parentNode}return!1},getAncestorWithStyle:function(e){for(var t;e;){if(t=!!this.cssStyle&&o(e,this.similarStyleRegExp),e.nodeType==c.ELEMENT_NODE&&"false"!=e.getAttribute("contenteditable")&&a.dom.arrayContains(this.tagNames,e.tagName.toLowerCase())&&t)return e;e=e.parentNode}return!1},getMatchingAncestor:function(e){var t=this.getAncestorWithClass(e),n=!1;return t?this.cssStyle&&(n="class"):(t=this.getAncestorWithStyle(e))&&(n="style"),{element:t,type:n}},postApply:function(e,t){for(var n,o,r,i=e[0],a=e[e.length-1],s=[],l=i,c=a,d=0,u=a.length,h=0,f=e.length;h<f;++h)r=null,(o=e[h])&&o.parentNode&&(r=this.getAdjacentMergeableTextNode(o.parentNode,!1)),r?(n||(n=new w(r),s.push(n)),n.textNodes.push(o),o===i&&(d=(l=n.firstTextNode).length),o===a&&(c=n.firstTextNode,u=n.getLength())):n=null;if(a&&a.parentNode){var m=this.getAdjacentMergeableTextNode(a.parentNode,!0);m&&(n||(n=new w(a),s.push(n)),n.textNodes.push(m))}if(s.length){for(h=0,f=s.length;h<f;++h)s[h].doMerge();t.setStart(l,d),t.setEnd(c,u)}},getAdjacentMergeableTextNode:function(e,t){var n,o=e.nodeType==c.TEXT_NODE,r=o?e.parentNode:e,i=t?"nextSibling":"previousSibling";if(o){if((n=e[i])&&n.nodeType==c.TEXT_NODE)return n}else if((n=r[i])&&this.areElementsMergeable(e,n))return n[t?"firstChild":"lastChild"];return null},areElementsMergeable:function(e,t){return a.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&a.dom.arrayContains(this.tagNames,(t.tagName||"").toLowerCase())&&m(e,t)&&g(e,t)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);return this.cssClass&&(t.className=this.cssClass),this.cssStyle&&t.setAttribute("style",this.cssStyle),t},applyToTextNode:function(e){var t=e.parentNode;if(1==t.childNodes.length&&a.dom.arrayContains(this.tagNames,t.tagName.toLowerCase()))this.cssClass&&i(t,this.cssClass,this.similarClassRegExp),this.cssStyle&&r(t,this.cssStyle,this.similarStyleRegExp);else{var n=this.createContainer(a.dom.getDocument(e));e.parentNode.insertBefore(n,e),n.appendChild(e)}},isRemovable:function(e){return a.dom.arrayContains(this.tagNames,e.tagName.toLowerCase())&&""===c.lang.string(e.className).trim()&&(!e.getAttribute("style")||""===c.lang.string(e.getAttribute("style")).trim())},undoToTextNode:function(e,t,n,o){var r=!n,i=n||o,a=!1;if(!t.containsNode(i)){var s=t.cloneRange();s.selectNode(i),s.isPointInRange(t.endContainer,t.endOffset)&&y(t.endContainer,t.endOffset)&&(v(i,t.endContainer,t.endOffset,this.container),t.setEndAfter(i)),s.isPointInRange(t.startContainer,t.startOffset)&&y(t.startContainer,t.startOffset)&&(i=v(i,t.startContainer,t.startOffset,this.container))}!r&&this.similarClassRegExp&&l(i,this.similarClassRegExp),r&&this.similarStyleRegExp&&(a="change"===f(i,this.cssStyle,this.similarStyleRegExp)),this.isRemovable(i)&&!a&&p(i)},applyToRange:function(e){for(var t,n=e.length;n--;){if(!(t=e[n].getNodes([c.TEXT_NODE])).length)try{var o=this.createContainer(e[n].endContainer.ownerDocument);return e[n].surroundContents(o),void this.selectNode(e[n],o)}catch(s){}if(e[n].splitBoundaries(),(t=e[n].getNodes([c.TEXT_NODE])).length){for(var r,i=0,a=t.length;i<a;++i)r=t[i],this.getMatchingAncestor(r).element||this.applyToTextNode(r);e[n].setStart(t[0],0),r=t[t.length-1],e[n].setEnd(r,r.length),this.normalize&&this.postApply(t,e[n])}}},undoToRange:function(e){for(var t,n,o,r=e.length;r--;){if((t=e[r].getNodes([c.TEXT_NODE])).length)e[r].splitBoundaries(),t=e[r].getNodes([c.TEXT_NODE]);else{var i=e[r].endContainer.ownerDocument.createTextNode(c.INVISIBLE_SPACE);e[r].insertNode(i),e[r].selectNode(i),t=[i]}for(var a=0,s=t.length;a<s;++a)e[r].isValid()&&(n=t[a],"style"===(o=this.getMatchingAncestor(n)).type?this.undoToTextNode(n,e[r],!1,o.element):o.element&&this.undoToTextNode(n,e[r],o.element));1==s?this.selectNode(e[r],t[0]):(e[r].setStart(t[0],0),n=t[t.length-1],e[r].setEnd(n,n.length),this.normalize&&this.postApply(t,e[r]))}},selectNode:function(e,t){var n=t.nodeType===c.ELEMENT_NODE,o=!("canHaveHTML"in t)||t.canHaveHTML,r=n?t.innerHTML:t.data,i=""===r||r===c.INVISIBLE_SPACE;if(i&&n&&o)try{t.innerHTML=c.INVISIBLE_SPACE}catch(a){}e.selectNodeContents(t),i&&n?e.collapse(!1):i&&(e.setStartAfter(t),e.setEndAfter(t))},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var o=n.intersection(t),r=o?o.toString():"";return n.detach(),r},isAppliedToRange:function(e){for(var t,n,o=[],r="full",i=e.length;i--;){if(!(n=e[i].getNodes([c.TEXT_NODE])).length)return!!(t=this.getMatchingAncestor(e[i].startContainer).element)&&{elements:[t],coverage:r};for(var a,s=0,l=n.length;s<l;++s)a=this.getTextSelectedByRange(n[s],e[i]),(t=this.getMatchingAncestor(n[s]).element)&&""!=a?(o.push(t),1===c.dom.getTextNodes(t,!0).length?r="full":"full"===r&&(r="inline")):t||(r="partial")}return!!o.length&&{elements:o,coverage:r}},toggleRange:function(e){var t,n=this.isAppliedToRange(e);n?"full"===n.coverage?this.undoToRange(e):"inline"===n.coverage?(t=h(n.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(e),t||this.applyToRange(e)):(h(n.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(e),this.applyToRange(e)):this.applyToRange(e)}},c.selection.HTMLApplier=e}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},support:function(e){return wysihtml5.browser.supportsCommand(this.doc,e)},exec:function(e,t){var n=wysihtml5.commands[e],o=wysihtml5.lang.array(arguments).get(),r=n&&n.exec,i=null;if(this.editor.fire("beforecommand:composer"),r)o.unshift(this.composer),i=r.apply(n,o);else try{i=this.doc.execCommand(e,!1,t)}catch(a){}return this.editor.fire("aftercommand:composer"),i},state:function(e){var t=wysihtml5.commands[e],n=wysihtml5.lang.array(arguments).get(),o=t&&t.state;if(o)return n.unshift(this.composer),o.apply(t,n);try{return this.doc.queryCommandState(e)}catch(r){return!1}},stateValue:function(e){var t=wysihtml5.commands[e],n=wysihtml5.lang.array(arguments).get(),o=t&&t.stateValue;return!!o&&(n.unshift(this.composer),o.apply(t,n))}}),wysihtml5.commands.bold={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"b")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"b")}},function(p){function r(e,t){var n,o,r,i,a,s,l,c,d,u=e.doc,h="_wysihtml5-temp-"+ +new Date,f=/non-matching-class/g,m=0;for(p.commands.formatInline.exec(e,g,y,h,f,g,g,!0,!0),n=(o=u.querySelectorAll(y+"."+h)).length;m<n;m++)for(d in(r=o[m]).removeAttribute("class"),t)"text"!==d&&r.setAttribute(d,t[d]);s=r,1===n&&(l=v.getTextContent(r),i=!!r.querySelector("*"),a=""===l||l===p.INVISIBLE_SPACE,!i&&a&&(v.setTextContent(r,t.text||r.href),c=u.createTextNode(" "),e.selection.setAfter(r),v.insert(c).after(r),s=c)),e.selection.setAfter(s)}function i(e,t,n){for(var o,r=t.length;r--;){for(var i=(o=t[r].attributes).length;i--;)t[r].removeAttribute(o.item(i).name);for(var a in n)n.hasOwnProperty(a)&&t[r].setAttribute(a,n[a])}}var g,y="A",v=p.dom;p.commands.createLink={exec:function(e,t,n){var o=this.state(e,t);o?e.selection.executeAndRestore(function(){i(e,o,n)}):r(e,n="object"==typeof n?n:{href:n})},state:function(e,t){return p.commands.formatInline.state(e,t,"A")}}}(wysihtml5),function(n){function o(e,t){for(var n,o,r=t.length,i=0;i<r;i++)n=t[i],o=a.getParentElement(n,{nodeName:"code"}),a.getTextContent(n).match(a.autoLink.URL_REG_EXP)&&!o?o=a.renameElement(n,"code"):a.replaceWithChildNodes(n)}var a=n.dom;n.commands.removeLink={exec:function(e,t){var n=this.state(e,t);n&&e.selection.executeAndRestore(function(){o(e,n)})},state:function(e,t){return n.commands.formatInline.state(e,t,"A")}}}(wysihtml5),function(o){var r=/wysiwyg-font-size-[0-9a-z\-]+/g;o.commands.fontSize={exec:function(e,t,n){o.commands.formatInline.execWithToggle(e,t,"span","wysiwyg-font-size-"+n,r)},state:function(e,t,n){return o.commands.formatInline.state(e,t,"span","wysiwyg-font-size-"+n,r)}}}(wysihtml5),function(r){var o=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;r.commands.fontSizeStyle={exec:function(e,t,n){n="object"==typeof n?n.size:n,/^\s*$/.test(n)||r.commands.formatInline.execWithToggle(e,t,"span",!1,!1,"font-size:"+n,o)},state:function(e,t){return r.commands.formatInline.state(e,t,"span",!1,!1,"font-size",o)},stateValue:function(e,t){var n,o=this.state(e,t);return o&&r.lang.object(o).isArray()&&(o=o[0]),!(!o||!(n=o.getAttribute("style")))&&r.quirks.styleParser.parseFontSize(n)}}}(wysihtml5),function(o){var r=/wysiwyg-color-[0-9a-z]+/g;o.commands.foreColor={exec:function(e,t,n){o.commands.formatInline.execWithToggle(e,t,"span","wysiwyg-color-"+n,r)},state:function(e,t,n){return o.commands.formatInline.state(e,t,"span","wysiwyg-color-"+n,r)}}}(wysihtml5),function(i){var a=/(\s|^)color\s*:\s*[^;\s]+;?/gi;i.commands.foreColorStyle={exec:function(e,t,n){var o,r=i.quirks.styleParser.parseColor("object"==typeof n?"color:"+n.color:"color:"+n,"color");r&&(o="color: rgb("+r[0]+","+r[1]+","+r[2]+");",1!==r[3]&&(o+="color: rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+");"),i.commands.formatInline.execWithToggle(e,t,"span",!1,!1,o,a))},state:function(e,t){return i.commands.formatInline.state(e,t,"span",!1,!1,"color",a)},stateValue:function(e,t,n){var o,r=this.state(e,t);return r&&i.lang.object(r).isArray()&&(r=r[0]),!!(r&&(o=r.getAttribute("style"))&&o)&&(val=i.quirks.styleParser.parseColor(o,"color"),i.quirks.styleParser.unparseColor(val,n))}}}(wysihtml5),function(a){var i=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;a.commands.bgColorStyle={exec:function(e,t,n){var o,r=a.quirks.styleParser.parseColor("object"==typeof n?"background-color:"+n.color:"background-color:"+n,"background-color");r&&(o="background-color: rgb("+r[0]+","+r[1]+","+r[2]+");",1!==r[3]&&(o+="background-color: rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+");"),a.commands.formatInline.execWithToggle(e,t,"span",!1,!1,o,i))},state:function(e,t){return a.commands.formatInline.state(e,t,"span",!1,!1,"background-color",i)},stateValue:function(e,t,n){var o,r=this.state(e,t),i=!1;return r&&a.lang.object(r).isArray()&&(r=r[0]),!(!r||!(o=r.getAttribute("style")))&&(i=a.quirks.styleParser.parseColor(o,"background-color"),a.quirks.styleParser.unparseColor(i,n))}}}(wysihtml5),function(p){function g(e,t,n){e.className?(v(e,n),e.className=p.lang.string(e.className+" "+t).trim()):e.className=t}function y(e,t,n){w(e,n),e.getAttribute("style")?e.setAttribute("style",p.lang.string(e.getAttribute("style")+" "+t).trim()):e.setAttribute("style",t)}function v(e,t){var n=t.test(e.className);return e.className=e.className.replace(t,""),""==p.lang.string(e.className).trim()&&e.removeAttribute("class"),n}function w(e,t){var n=t.test(e.getAttribute("style"));return e.setAttribute("style",(e.getAttribute("style")||"").replace(t,"")),""==p.lang.string(e.getAttribute("style")||"").trim()&&e.removeAttribute("style"),n}function i(e){var t=e.lastChild;t&&n(t)&&t.parentNode.removeChild(t)}function n(e){return"BR"===e.nodeName}function b(e,t){e.selection.isCollapsed()&&e.selection.selectLine();for(var n=e.selection.surround(t),o=0,r=n.length;o<r;o++)p.dom.lineBreaks(n[o]).remove(),i(n[o])}function C(e){return!!p.lang.string(e.className).trim()}function x(e){return!!p.lang.string(e.getAttribute("style")||"").trim()}var N=p.dom,E=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];p.commands.formatBlock={exec:function(t,e,o,n,r,i,a){t.doc;var s,l,c,d,u,h=this.state(t,e,o,n,r,i,a),f=t.config.useLineBreaks,m=f?"DIV":"P";o="string"==typeof o?o.toUpperCase():o,h.length?t.selection.executeAndRestoreRangy(function(){for(var e=h.length;e--;){if(r&&(l=v(h[e],r)),a&&(d=w(h[e],a)),(d||l)&&null===o&&h[e].nodeName!=m)return;var t=C(h[e]),n=x(h[e]);t||n||!f&&"P"!==o?N.renameElement(h[e],"P"===o?"DIV":m):(p.dom.lineBreaks(h[e]).add(),N.replaceWithChildNodes(h[e]))}}):(null===o||p.lang.array(E).contains(o))&&(s=t.selection.findNodesInSelection(E).concat(t.selection.getSelectedOwnNodes()),t.selection.executeAndRestoreRangy(function(){for(var e=s.length;e--;)(u=N.getParentElement(s[e],{nodeName:E}))==t.element&&(u=null),u&&(o&&(u=N.renameElement(u,o)),n&&g(u,n,r),i&&y(u,i,a),c=!0)}),c)||b(t,{nodeName:o||m,className:n||null,cssStyle:i||null})},state:function(e,t,n,o,r,i,a){var s,l=e.selection.getSelectedOwnNodes(),c=[];n="string"==typeof n?n.toUpperCase():n;for(var d=0,u=l.length;d<u;d++)(s=N.getParentElement(l[d],{nodeName:n,className:o,classRegExp:r,cssStyle:i,styleRegExp:a}))&&-1==p.lang.array(c).indexOf(s)&&c.push(s);return 0!=c.length&&c}}}(wysihtml5),wysihtml5.commands.formatCode={exec:function(e,t,n){var o,r,i,a=this.state(e);a?e.selection.executeAndRestore(function(){o=a.querySelector("code"),wysihtml5.dom.replaceWithChildNodes(a),o&&wysihtml5.dom.replaceWithChildNodes(o)}):(i=(r=e.selection.getRange()).extractContents(),a=e.doc.createElement("pre"),o=e.doc.createElement("code"),n&&(o.className=n),a.appendChild(o),o.appendChild(i),r.insertNode(a),e.selection.selectNode(a))},state:function(e){var t=e.selection.getSelectedNode();return t&&t.nodeName&&"PRE"==t.nodeName&&t.firstChild&&t.firstChild.nodeName&&"CODE"==t.firstChild.nodeName?t:wysihtml5.dom.getParentElement(t,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(t,{nodeName:"PRE"})}},function(u){function s(e){var t=f[e];return t?[e.toLowerCase(),t.toLowerCase()]:[e.toLowerCase()]}function h(e,t,n,o,r,i){var a=e;return t&&(a+=":"+t),o&&(a+=":"+o),l[a]||(l[a]=new u.selection.HTMLApplier(s(e),t,n,!0,o,r,i)),l[a]}var f={strong:"b",em:"i",b:"strong",i:"em"},l={};u.commands.formatInline={exec:function(e,t,n,o,r,i,a,s,l){var c=e.selection.createRange(),d=e.selection.getOwnRanges();if(!d||0==d.length)return!1;e.selection.getSelection().removeAllRanges(),h(n,o,r,i,a,e.element).toggleRange(d),s?l||e.cleanUp():(c.setStart(d[0].startContainer,d[0].startOffset),c.setEnd(d[d.length-1].endContainer,d[d.length-1].endOffset),e.selection.setSelection(c),e.selection.executeAndRestore(function(){l||e.cleanUp()},!0,!0))},execWithToggle:function(e,t,n,o,r,i,a){var s=this;if(this.state(e,t,n,o,r,i,a)&&e.selection.isCollapsed()&&!e.selection.caretIsLastInSelection()&&!e.selection.caretIsFirstInSelection()){var l=s.state(e,t,n,o,r)[0];e.selection.executeAndRestoreRangy(function(){l.parentNode;e.selection.selectNode(l,!0),u.commands.formatInline.exec(e,t,n,o,r,i,a,!0,!0)})}else this.state(e,t,n,o,r,i,a)&&!e.selection.isCollapsed()?e.selection.executeAndRestoreRangy(function(){u.commands.formatInline.exec(e,t,n,o,r,i,a,!0,!0)}):u.commands.formatInline.exec(e,t,n,o,r,i,a)},state:function(e,t,n,o,r,i,a){var s,l,c=e.doc,d=f[n]||n;return!(!u.dom.hasElementWithTagName(c,n)&&!u.dom.hasElementWithTagName(c,d))&&(!(o&&!u.dom.hasElementWithClassName(c,o))&&(!(!(s=e.selection.getOwnRanges())||0===s.length)&&(!(!(l=h(n,o,r,i,a,e.element).isAppliedToRange(s))||!l.elements)&&l.elements)))}}}(wysihtml5),function(r){r.commands.insertBlockQuote={exec:function(t,e){var n=this.state(t,e),o=t.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]);t.selection.executeAndRestore(function(){if(n)t.config.useLineBreaks&&r.dom.lineBreaks(n).add(),r.dom.unwrap(n);else if(t.selection.isCollapsed()&&t.selection.selectLine(),o){var e=o.ownerDocument.createElement("blockquote");r.dom.insert(e).after(o),e.appendChild(o)}else t.selection.surround({nodeName:"blockquote"})})},state:function(e){var t=e.selection.getSelectedNode(),n=r.dom.getParentElement(t,{nodeName:"BLOCKQUOTE"},!1,e.element);return n||!1}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(e,t,n){e.commands.support(t)?e.doc.execCommand(t,!1,n):e.selection.insertHTML(n)},state:function(){return!1}},function(l){var c="IMG";l.commands.insertImage={exec:function(e,t,n){n="object"==typeof n?n:{src:n};var o,r,i=e.doc,a=this.state(e);if(a)return e.selection.setBefore(a),(r=a.parentNode).removeChild(a),l.dom.removeEmptyTextNodes(r),"A"!==r.nodeName||r.firstChild||(e.selection.setAfter(r),r.parentNode.removeChild(r)),void l.quirks.redraw(e.element);for(var s in a=i.createElement(c),n)a.setAttribute("className"===s?"class":s,n[s]);e.selection.insertNode(a),l.browser.hasProblemsSettingCaretAfterImg()?(o=i.createTextNode(l.INVISIBLE_SPACE),e.selection.insertNode(o),e.selection.setAfter(o)):e.selection.setAfter(a)},state:function(e){var t,n,o,r=e.doc;return!!l.dom.hasElementWithTagName(r,c)&&(!!(t=e.selection.getSelectedNode())&&(t.nodeName===c?t:t.nodeType===l.ELEMENT_NODE&&(n=e.selection.getText(),!(n=l.lang.string(n).trim())&&(1===(o=e.selection.getNodes(l.ELEMENT_NODE,function(e){return"IMG"===e.nodeName})).length&&o[0]))))}}}(wysihtml5),function(n){var o="<br>"+(n.browser.needsSpaceAfterLineBreak()?" ":"")
;n.commands.insertLineBreak={exec:function(e,t){e.commands.support(t)?(e.doc.execCommand(t,!1,null),n.browser.autoScrollsToCaret()||e.selection.scrollIntoView()):e.commands.exec("insertHTML",o)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"OL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"OL")}},wysihtml5.commands.insertUnorderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"UL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"UL")}},wysihtml5.commands.insertList=function(l){var a=function(e,t){if(e&&e.nodeName){"string"==typeof t&&(t=[t]);for(var n=t.length;n--;)if(e.nodeName===t[n])return!0}return!1},s=function(e,t,n){var o={el:null,other:!1};if(e){var r=l.dom.getParentElement(e,{nodeName:"LI"}),i="UL"===t?"OL":"UL";a(e,t)?o.el=e:a(e,i)?o={el:e,other:!0}:r&&(a(r.parentNode,t)?o.el=r.parentNode:a(r.parentNode,i)&&(o={el:r.parentNode,other:!0}))}return o.el&&!n.element.contains(o.el)&&(o.el=null),o},c=function(o,r,i){var a,s="UL"===r?"OL":"UL";i.selection.executeAndRestore(function(){var e=u(s,i);if(e.length)for(var t=e.length;t--;)l.dom.renameElement(e[t],r.toLowerCase());else{for(var n=(a=u(["OL","UL"],i)).length;n--;)l.dom.resolveList(a[n],i.config.useLineBreaks);l.dom.resolveList(o,i.config.useLineBreaks)}})},d=function(n,o,r){var i="UL"===o?"OL":"UL";r.selection.executeAndRestore(function(){for(var e=[n].concat(u(i,r)),t=e.length;t--;)l.dom.renameElement(e[t],o.toLowerCase())})},u=function(t,e){for(var n=e.selection.getOwnRanges(),o=[],r=n.length;r--;)o=o.concat(n[r].getNodes([1],function(e){return a(e,t)}));return o},h=function(i,a){a.selection.executeAndRestoreRangy(function(){var e,t,n="_wysihtml5-temp-"+(new Date).getTime(),o=a.selection.deblockAndSurround({nodeName:"div",className:n}),r=/\uFEFF/g;o.innerHTML=o.innerHTML.replace(r,""),o&&(e=l.lang.array(["","<br>",l.INVISIBLE_SPACE]).contains(o.innerHTML),t=l.dom.convertToList(o,i.toLowerCase(),a.parent.config.uneditableContainerClassname),e&&a.selection.selectNode(t.querySelector("li"),!0))})};return{exec:function(e,t,n){var o=e.doc,r="OL"===n?"insertOrderedList":"insertUnorderedList",i=e.selection.getSelectedNode(),a=s(i,n,e);a.el?a.other?d(a.el,n,e):c(a.el,n,e):e.commands.support(r)?o.execCommand(r,!1,null):h(n,e)},state:function(e,t,n){var o=e.selection.getSelectedNode(),r=s(o,n,e);return!(!r.el||r.other)&&r.el}}}(wysihtml5),wysihtml5.commands.italic={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"i")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"i")}},function(t){var n="wysiwyg-text-align-center",o=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyCenter={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,n,o)}}}(wysihtml5),function(t){var n="wysiwyg-text-align-left",o=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyLeft={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,n,o)}}}(wysihtml5),function(t){var n="wysiwyg-text-align-right",o=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyRight={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,n,o)}}}(wysihtml5),function(t){var n="wysiwyg-text-align-justify",o=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyFull={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,n,o)}}}(wysihtml5),function(t){var n="text-align: right;",o=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignRightStyle={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,null,null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,null,null,n,o)}}}(wysihtml5),function(t){var n="text-align: left;",o=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignLeftStyle={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,null,null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,null,null,n,o)}}}(wysihtml5),function(t){var n="text-align: center;",o=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignCenterStyle={exec:function(e){return t.commands.formatBlock.exec(e,"formatBlock",null,null,null,n,o)},state:function(e){return t.commands.formatBlock.state(e,"formatBlock",null,null,null,n,o)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(e){return e.undoManager.redo()},state:function(){return!1}},wysihtml5.commands.underline={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"u")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"u")}},wysihtml5.commands.undo={exec:function(e){return e.undoManager.undo()},state:function(){return!1}},wysihtml5.commands.createTable={exec:function(e,t,n){var o,r,i;if(n&&n.cols&&n.rows&&0<parseInt(n.cols,10)&&0<parseInt(n.rows,10)){for(i=n.tableStyle?'<table style="'+n.tableStyle+'">':"<table>",i+="<tbody>",r=0;r<n.rows;r++){for(i+="<tr>",o=0;o<n.cols;o++)i+="<td>&nbsp;</td>";i+="</tr>"}i+="</tbody></table>",e.commands.exec("insertHTML",i)}},state:function(){return!1}},wysihtml5.commands.mergeTableCells={exec:function(e,t){e.tableSelection&&e.tableSelection.start&&e.tableSelection.end&&(this.state(e,t)?wysihtml5.dom.table.unmergeCell(e.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(e.tableSelection.start,e.tableSelection.end))},state:function(e){if(e.tableSelection){var t=e.tableSelection.start,n=e.tableSelection.end;if(t&&n&&t==n&&(wysihtml5.dom.getAttribute(t,"colspan")&&1<parseInt(wysihtml5.dom.getAttribute(t,"colspan"),10)||wysihtml5.dom.getAttribute(t,"rowspan")&&1<parseInt(wysihtml5.dom.getAttribute(t,"rowspan"),10)))return[t]}return!1}},wysihtml5.commands.addTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end);"before"==n||"above"==n?wysihtml5.dom.table.addCells(o.start,n):"after"!=n&&"below"!=n||wysihtml5.dom.table.addCells(o.end,n),setTimeout(function(){e.tableSelection.select(o.start,o.end)},0)}},state:function(){return!1}},wysihtml5.commands.deleteTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o,r=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end),i=wysihtml5.dom.table.indexOf(r.start),a=e.tableSelection.table;wysihtml5.dom.table.removeCells(r.start,n),setTimeout(function(){(o=wysihtml5.dom.table.findCell(a,i))||("row"==n&&(o=wysihtml5.dom.table.findCell(a,{row:i.row-1,col:i.col})),"column"==n&&(o=wysihtml5.dom.table.findCell(a,{row:i.row,col:i.col-1}))),o&&e.tableSelection.select(o,o)},0)}},state:function(){return!1}},wysihtml5.commands.indentList={exec:function(e){var t=e.selection.getSelectionParentsByTag("LI");return!!t&&this.tryToPushLiLevel(t,e.selection)},state:function(){return!1},tryToPushLiLevel:function(t,e){var n,o,r,i,a,s=!1;return e.executeAndRestoreRangy(function(){for(var e=t.length;e--;)i=t[e],n="OL"===i.parentNode.nodeName?"OL":"UL",o=i.ownerDocument.createElement(n),r=wysihtml5.dom.domNode(i).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}),a=r?r.querySelector("ul, ol"):null,r&&(a?a.appendChild(i):(o.appendChild(i),r.appendChild(o)),s=!0)}),s}},wysihtml5.commands.outdentList={exec:function(e){var t=e.selection.getSelectionParentsByTag("LI");return!!t&&this.tryToPullLiLevel(t,e)},state:function(){return!1},tryToPullLiLevel:function(n,o){var r,i,a,s,l,c=!1,d=this;return o.selection.executeAndRestoreRangy(function(){for(var e=n.length;e--;)if((s=n[e]).parentNode&&("OL"===(r=s.parentNode).tagName||"UL"===r.tagName)){if(c=!0,i=wysihtml5.dom.getParentElement(r.parentNode,{nodeName:["OL","UL"]},!1,o.element),a=wysihtml5.dom.getParentElement(r.parentNode,{nodeName:["LI"]},!1,o.element),i&&a)s.nextSibling&&(l=d.getAfterList(r,s),s.appendChild(l)),i.insertBefore(s,a.nextSibling);else{s.nextSibling&&(l=d.getAfterList(r,s),s.appendChild(l));for(var t=s.childNodes.length;t--;)r.parentNode.insertBefore(s.childNodes[t],r.nextSibling);r.parentNode.insertBefore(document.createElement("br"),r.nextSibling),s.parentNode.removeChild(s)}0===r.childNodes.length&&r.parentNode.removeChild(r)}}),c},getAfterList:function(e,t){for(var n=e.nodeName,o=document.createElement(n);t.nextSibling;)o.appendChild(t.nextSibling);return o}},function(d){var i=90,a=89,o=8,s=46,u=25,h="data-wysihtml5-selection-node",f="data-wysihtml5-selection-offset",e=(d.INVISIBLE_SPACE,d.INVISIBLE_SPACE,d.dom);d.UndoManager=d.lang.Dispatcher.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var n,r=this;this.composer.sandbox.getDocument();e.observe(this.element,"keydown",function(e){if(!e.altKey&&(e.ctrlKey||e.metaKey)){var t=e.keyCode,n=t===i&&!e.shiftKey,o=t===i&&e.shiftKey||t===a;n?(r.undo(),e.preventDefault()):o&&(r.redo(),e.preventDefault())}}),e.observe(this.element,"keydown",function(e){var t=e.keyCode;t!==n&&((n=t)!==o&&t!==s||r.transact())}),this.editor.on("newword:composer",function(){r.transact()}).on("beforecommand:composer",function(){r.transact()})},transact:function(){var e,t,n,o,r,i=this.historyStr[this.position-1],a=this.composer.getValue(!1,!1),s=0<this.element.offsetWidth&&0<this.element.offsetHeight;if(a!==i){var l=this.historyStr.length=this.historyDom.length=this.position;u<l&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++,s&&(t=(e=this.composer.selection.getRange())&&e.startContainer?e.startContainer:this.element,n=e&&e.startOffset?e.startOffset:0,t.nodeType===d.ELEMENT_NODE?o=t:(o=t.parentNode,r=this.getChildNodeIndex(o,t)),o.setAttribute(f,n),void 0!==r&&o.setAttribute(h,r));var c=this.element.cloneNode(!!a);this.historyDom.push(c),this.historyStr.push(a),o&&(o.removeAttribute(f),o.removeAttribute(h))}},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return 1<this.position},redoPossible:function(){return this.position<this.historyStr.length},set:function(e){this.element.innerHTML="";for(var t,n,o,r=0,i=e.childNodes,a=e.childNodes.length;r<a;r++)this.element.appendChild(i[r].cloneNode(!0));e.hasAttribute(f)?(t=e.getAttribute(f),o=e.getAttribute(h),n=this.element):(t=(n=this.element.querySelector("["+f+"]")||this.element).getAttribute(f),o=n.getAttribute(h),n.removeAttribute(f),n.removeAttribute(h)),null!==o&&(n=this.getChildNodeByIndex(n,+o)),this.composer.selection.set(n,t)},getChildNodeIndex:function(e,t){for(var n=0,o=e.childNodes,r=o.length;n<r;n++)if(o[n]===t)return n},getChildNodeByIndex:function(e,t){return e.childNodes[t]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,t,n){this.parent=e,this.element=t,this.config=n,this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var t=this;this.parent.on("beforeload",function(){t.parent.on("change_view",function(e){e===t.name?((t.parent.currentView=t).show(),setTimeout(function(){t.focus()},0)):t.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(l){var c=l.dom,d=l.browser;l.views.Composer=l.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n),this.config.noTextarea?this.editableArea=t:this.textarea=this.parent.textarea,this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=d.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(e,t){var n=this.isEmpty()?"":l.quirks.getCorrectInnerHTML(this.element);return!1!==e&&(n=this.parent.parse(n,!1!==t)),n},setValue:function(e,t){t&&(e=this.parent.parse(e));try{this.element.innerHTML=e}catch(n){this.element.innerText=e}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"",this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=c.getStyle("display").from(this.editableArea),"none"===this._displayStyle&&(this._displayStyle=null),this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(e){l.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var t=this.element.lastChild;e&&t&&this.selection&&("BR"===t.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return c.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(e)||""===e||"<br>"===e||"<p></p>"===e||"<p><br></p>"===e||this.hasPlaceholderSet()},_initContentEditableArea:function(){var e=this;this.config.noTextarea?this.sandbox=new c.ContentEditableArea(function(){e._create()},{},this.editableArea):(this.sandbox=new c.ContentEditableArea(function(){e._create()}),this.editableArea=this.sandbox.getContentEditable(),c.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var e=this;this.sandbox=new c.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets}),this.editableArea=this.sandbox.getIframe();var t=this.textarea.element;c.insert(this.editableArea).after(t),this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var e=document.createElement("input");e.type="hidden",e.name="_wysihtml5_mode",e.value=1,c.insert(e).after(this.textarea.element)}},_create:function(){var e=this;this.doc=this.sandbox.getDocument(),this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body,this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1)),this.selection=new l.Selection(this.parent,this.element,this.config.uneditableContainerClassname),this.commands=new l.Commands(this.parent),this.config.noTextarea||c.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),c.addClass(this.element,this.config.composerClassName),this.config.style&&!this.config.contentEditableMode&&this.style(),this.observe();var t=this.config.name;t&&(c.addClass(this.element,t),this.config.contentEditableMode||c.addClass(this.editableArea,t)),this.enable(),!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();var n="string"==typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder");n&&c.simulatePlaceholder(this.parent,this,n),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||d.isIos()||setTimeout(function(){e.focus(!0)},100),d.clearsContentEditableCorrectly()||l.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.config.noTextarea||this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var i=this,e=d.canDisableAutoLinking(),t=d.doesAutoLinkingInContentEditable();if(e&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!t||t&&e)&&(this.parent.on("newword:composer",function(){c.getTextContent(i.element).match(c.autoLink.URL_REG_EXP)&&i.selection.executeAndRestore(function(e,t){for(var n=i.element.querySelectorAll("."+i.config.uneditableContainerClassname),o=!1,r=n.length;r--;)l.dom.contains(n[r],t)&&(o=!0);o||c.autoLink(t.parentNode,[i.config.uneditableContainerClassname])})}),c.observe(this.element,"blur",function(){c.autoLink(i.element,[i.config.uneditableContainerClassname])}));var r=this.sandbox.getDocument().getElementsByTagName("a"),a=c.autoLink.URL_REG_EXP,s=function(e){var t=l.lang.string(c.getTextContent(e)).trim();return"www."===t.substr(0,4)&&(t="http://"+t),t};c.observe(this.element,"keydown",function(e){if(r.length){var t,n=i.selection.getSelectedNode(e.target.ownerDocument),o=c.getParentElement(n,{nodeName:"A"},4);o&&(t=s(o),setTimeout(function(){var e=s(o);e!==t&&e.match(a)&&o.setAttribute("href",e)},0))}})}},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),d.supportsEvent("resizeend")){var i=["width","height"],a=i.length,s=this.element;c.observe(s,"resizeend",function(e){var t,n=e.target||e.srcElement,o=n.style,r=0;if("IMG"===n.nodeName){for(;r<a;r++)o[t=i[r]]&&(n.setAttribute(t,parseInt(o[t],10)),o[t]="");l.quirks.redraw(s)}})}},_initUndoManager:function(){this.undoManager=new l.UndoManager(this.parent)},_initLineBreaking:function(){function o(e){var t=c.getParentElement(e,{nodeName:["P","DIV"]},2);t&&c.contains(r.element,t)&&r.selection.executeAndRestore(function(){r.config.useLineBreaks?c.replaceWithChildNodes(t):"P"!==t.nodeName&&c.renameElement(t,"p")})}var r=this,i=["LI","P","H1","H2","H3","H4","H5","H6"],a=["UL","OL","MENU"];this.config.useLineBreaks||c.observe(this.element,["focus","keydown"],function(){if(r.isEmpty()){var e=r.doc.createElement("P");r.element.innerHTML="",r.element.appendChild(e),d.displaysCaretInEmptyContentEditableCorrectly()?r.selection.selectNode(e,!0):(e.innerHTML="<br>",r.selection.setBefore(e.firstChild))}}),c.observe(this.element,"keydown",function(e){var t=e.keyCode;if(!e.shiftKey&&(t===l.ENTER_KEY||t===l.BACKSPACE_KEY)){var n=c.getParentElement(r.selection.getSelectedNode(),{nodeName:i},4);n?setTimeout(function(){var e=r.selection.getSelectedNode();if("LI"===n.nodeName){if(!e)return;c.getParentElement(e,{nodeName:a},2)||o(e)}t===l.ENTER_KEY&&n.nodeName.match(/^H[1-6]$/)&&o(e)},0):r.config.useLineBreaks&&t===l.ENTER_KEY&&!l.browser.insertsLineBreaksOnReturn()&&(e.preventDefault(),r.commands.exec("insertLineBreak"))}})}})}(wysihtml5),function(c){var d=c.dom,u=document,a=window,h=u.createElement("div"),f=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],m=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],p=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",".wysiwyg-color-black {color: black;}",".wysiwyg-color-silver {color: silver;}",".wysiwyg-color-gray {color: gray;}",".wysiwyg-color-white {color: white;}",".wysiwyg-color-maroon {color: maroon;}",".wysiwyg-color-red {color: red;}",".wysiwyg-color-purple {color: purple;}",".wysiwyg-color-fuchsia {color: fuchsia;}",".wysiwyg-color-green {color: green;}",".wysiwyg-color-lime {color: lime;}",".wysiwyg-color-olive {color: olive;}",".wysiwyg-color-yellow {color: yellow;}",".wysiwyg-color-navy {color: navy;}",".wysiwyg-color-blue {color: blue;}",".wysiwyg-color-teal {color: teal;}",".wysiwyg-color-aqua {color: aqua;}",".wysiwyg-color-orange {color: orange;}",c.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],g=function(e){if(e.setActive)try{e.setActive()}catch(i){}else{var t=e.style,n=u.documentElement.scrollTop||u.body.scrollTop,o=u.documentElement.scrollLeft||u.body.scrollLeft,r={position:t.position,top:t.top,left:t.left,WebkitUserSelect:t.WebkitUserSelect};d.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e),e.focus(),d.setStyles(r).on(e),a.scrollTo&&a.scrollTo(o,n)}};c.views.Composer.prototype.style=function(){var e,t=this,n=u.querySelector(":focus"),o=this.textarea.element,r=o.hasAttribute("placeholder"),i=r&&o.getAttribute("placeholder"),a=o.style.display,s=o.disabled;this.focusStylesHost=h.cloneNode(!1),this.blurStylesHost=h.cloneNode(!1),this.disabledStylesHost=h.cloneNode(!1),r&&o.removeAttribute("placeholder"),o===n&&o.blur(),o.disabled=!1,o.style.display=e="none",(o.getAttribute("rows")&&"auto"===d.getStyle("height").from(o)||o.getAttribute("cols")&&"auto"===d.getStyle("width").from(o))&&(o.style.display=e=a),d.copyStyles(m).from(o).to(this.editableArea).andTo(this.blurStylesHost),d.copyStyles(f).from(o).to(this.element).andTo(this.blurStylesHost),d.insertCSS(p).into(this.element.ownerDocument),o.disabled=!0,d.copyStyles(m).from(o).to(this.disabledStylesHost),d.copyStyles(f).from(o).to(this.disabledStylesHost),o.disabled=s,o.style.display=a,g(o),o.style.display=e,d.copyStyles(m).from(o).to(this.focusStylesHost),d.copyStyles(f).from(o).to(this.focusStylesHost),o.style.display=a,d.copyStyles(["display"]).from(o).to(this.editableArea);var l=c.lang.array(m).without(["display"]);return n?n.focus():o.blur(),r&&o.setAttribute("placeholder",i),this.parent.on("focus:composer",function(){d.copyStyles(l).from(t.focusStylesHost).to(t.editableArea),d.copyStyles(f).from(t.focusStylesHost).to(t.element)}),this.parent.on("blur:composer",function(){d.copyStyles(l).from(t.blurStylesHost).to(t.editableArea),d.copyStyles(f).from(t.blurStylesHost).to(t.element)}),this.parent.observe("disable:composer",function(){d.copyStyles(l).from(t.disabledStylesHost).to(t.editableArea),d.copyStyles(f).from(t.disabledStylesHost).to(t.element)}),this.parent.observe("enable:composer",function(){d.copyStyles(l).from(t.blurStylesHost).to(t.editableArea),d.copyStyles(f).from(t.blurStylesHost).to(t.element)}),this}}(wysihtml5),function(c){var d=c.dom,u=c.browser,h={66:"bold",73:"italic",85:"underline"},s=function(e,t,n){var o=e.getPreviousNode(t,!0),r=e.getSelectedNode();if(1!==r.nodeType&&r.parentNode!==n&&(r=r.parentNode),o)if(1==r.nodeType){var i=r.firstChild;if(1==o.nodeType)for(;r.firstChild;)o.appendChild(r.firstChild);else for(;r.firstChild;)t.parentNode.insertBefore(r.firstChild,t);r.parentNode&&r.parentNode.removeChild(r),e.setBefore(i)}else 1==o.nodeType?o.appendChild(r):t.parentNode.insertBefore(r,t),e.setBefore(r)},f=function(e,t,n,o){if(t.isCollapsed())if(t.caretIsInTheBeginnig("LI"))e.preventDefault(),o.commands.exec("outdentList");else if(t.caretIsInTheBeginnig())e.preventDefault();else{if(t.caretIsFirstInSelection()&&t.getPreviousNode()&&t.getPreviousNode().nodeName&&/^H\d$/gi.test(t.getPreviousNode().nodeName)){var r=t.getPreviousNode();if(e.preventDefault(),/^\s*$/.test(r.textContent||r.innerText))r.parentNode.removeChild(r);else{var i=r.ownerDocument.createRange();i.selectNodeContents(r),i.collapse(!1),t.setSelection(i)}}var a=t.caretIsBeforeUneditable();a&&(e.preventDefault(),s(t,a,n))}else t.containsUneditable()&&(e.preventDefault(),t.deleteContents())},m=function(e){if(e.selection.isCollapsed()){if(e.selection.caretIsInTheBeginnig("LI")&&e.commands.exec("indentList"))return}else e.selection.deleteContents();e.commands.exec("insertHTML","&emsp;")};c.views.Composer.prototype.observe=function(){var i=this,n=this.getValue(!1,!1),e=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),a=this.element,t=u.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?a:this.sandbox.getWindow(),o=["drop","paste"],r=["drop","paste","mouseup","focus","keyup"];if(d.observe(e,"DOMNodeRemoved",function(){clearInterval(s),i.parent.fire("destroy:composer")}),!u.supportsMutationEvents())var s=setInterval(function(){d.contains(document.documentElement,e)||(clearInterval(s),i.parent.fire("destroy:composer"))},250);d.observe(t,r,function(){setTimeout(function(){i.parent.fire("interaction").fire("interaction:composer")},0)}),this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&c.browser.supportsCommand(this.doc,"enableObjectResizing")&&c.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=d.observe(e,["focus","mouseup","mouseover"],function(){i.doc.execCommand("enableObjectResizing",!1,"false"),i.doc.execCommand("enableInlineTableEditing",!1,"false"),i.tableClickHandle.stop()}):setTimeout(function(){i.doc.execCommand("enableObjectResizing",!1,"false"),i.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=c.quirks.tableCellsSelection(a,i.parent)),d.observe(t,"focus",function(e){i.parent.fire("focus",e).fire("focus:composer",e),setTimeout(function(){n=i.getValue(!1,!1)},0)}),d.observe(t,"blur",function(e){if(n!==i.getValue(!1,!1)){var t=e;"function"==typeof Object.create&&(t=Object.create(e,{type:{value:"change"}})),i.parent.fire("change",t).fire("change:composer",t)}i.parent.fire("blur",e).fire("blur:composer",e)}),d.observe(a,"dragenter",function(){i.parent.fire("unset_placeholder")}),d.observe(a,o,function(e){setTimeout(function(){i.parent.fire(e.type,e).fire(e.type+":composer",e)},0)}),d.observe(a,"keyup",function(e){var t=e.keyCode;t!==c.SPACE_KEY&&t!==c.ENTER_KEY||i.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")},0)}),u.canSelectImagesInContentEditable()||d.observe(a,"mousedown",function(e){var t=e.target,n=a.querySelectorAll("img"),o=a.querySelectorAll("."+i.config.uneditableContainerClassname+" img"),r=c.lang.array(n).without(o);"IMG"===t.nodeName&&c.lang.array(r).contains(t)&&i.selection.selectNode(t)}),u.canSelectImagesInContentEditable()||d.observe(a,"drop",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}),u.hasHistoryIssue()&&u.supportsSelectionModify()&&d.observe(a,"keydown",function(e){if(e.metaKey||e.ctrlKey){var t=e.keyCode,n=a.ownerDocument.defaultView.getSelection();37!==t&&39!==t||(37===t&&(n.modify("extend","left","lineboundary"),e.shiftKey||n.collapseToStart()),39===t&&(n.modify("extend","right","lineboundary"),e.shiftKey||n.collapseToEnd()),e.preventDefault())}}),d.observe(a,"keydown",function(e){var t=e.keyCode,n=h[t];(e.ctrlKey||e.metaKey)&&!e.altKey&&n&&(i.commands.exec(n),e.preventDefault()),8===t?f(e,i.selection,a,i):i.config.handleTabKey&&9===t&&(e.preventDefault(),m(i,a))}),d.observe(a,"keydown",function(e){var t,n=i.selection.getSelectedNode(!0),o=e.keyCode;!n||"IMG"!==n.nodeName||o!==c.BACKSPACE_KEY&&o!==c.DELETE_KEY||((t=n.parentNode).removeChild(n),"A"!==t.nodeName||t.firstChild||t.parentNode.removeChild(t),setTimeout(function(){c.quirks.redraw(a)},0),e.preventDefault())}),!this.config.contentEditableMode&&u.hasIframeFocusIssue()&&(d.observe(e,"focus",function(){setTimeout(function(){i.doc.querySelector(":focus")!==i.element&&i.focus()},0)}),d.observe(this.element,"blur",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}));var l={IMG:"Image: ",A:"Link: "};d.observe(a,"mouseover",function(e){var t,n=e.target,o=n.nodeName;"A"!==o&&"IMG"!==o||(n.hasAttribute("title")||(t=l[o]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",t)))})}}(wysihtml5),function(i){var a=400;i.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(e){this.textarea.setValue(i.lang.string(this.composer.getValue(!1,!1)).trim(),e)},fromTextareaToComposer:function(e){var t=this.textarea.getValue(!1,!1);t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var t,n=this,e=this.textarea.element.form,o=function(){t=setInterval(function(){n.fromComposerToTextarea()},a)},r=function(){clearInterval(t),t=null};o(),e&&(i.dom.observe(e,"submit",function(){n.sync(!0)}),i.dom.observe(e,"reset",function(){setTimeout(function(){n.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(e){"composer"!==e||t?"textarea"===e&&(n.fromComposerToTextarea(!0),r()):(n.fromTextareaToComposer(!0),o())}),this.editor.on("destroy:composer",r)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n),this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;return!1!==e&&(t=this.parent.parse(t)),t},setValue:function(e,t){t&&(e=this.parent.parse(e)),this.element.value=e},cleanUp:function(){var e=this.parent.parse(this.element.value);this.element.value=e},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,n=this.element.value;return e&&!n||n===t},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,n=this.parent,o={focusin:"focus",focusout:"blur"},t=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];n.on("beforeload",function(){wysihtml5.dom.observe(e,t,function(e){var t=o[e.type]||e.type;n.fire(t).fire(t+":textarea")}),wysihtml5.dom.observe(e,["paste","drop"],function(){setTimeout(function(){n.fire("paste").fire("paste:textarea")},0)})})}}),function(r){var e,o={name:e,style:!0,toolbar:e,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:r.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:e,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container"};r.Editor=r.lang.Dispatcher.extend({constructor:function(e,t){if(this.editableElement="string"==typeof e?document.getElementById(e):e,this.config=r.lang.object({}).merge(o).merge(t).get(),this._isCompatible=r.browser.supported(),"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0),this.config.noTextarea||(this.textarea=new r.views.Textarea(this,this.editableElement,this.config),this.currentView=this.textarea),!this._isCompatible||!this.config.supportTouchDevices&&r.browser.isTouchDevice()){var n=this;setTimeout(function(){n.fire("beforeload").fire("load")},0)}else r.dom.addClass(document.body,this.config.bodyClassName),this.composer=new r.views.Composer(this,this.editableElement,this.config),
this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new r.views.Synchronizer(this,this.textarea,this.composer)),this.config.toolbar&&(this.toolbar=new r.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(e,t){return this.currentView.getValue(e,t)},setValue:function(e,t){return this.fire("unset_placeholder"),e?(this.currentView.setValue(e,t),this):this.clear()},cleanUp:function(){this.currentView.cleanUp()},focus:function(e){return this.currentView.focus(e),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(e,t){var n=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,o=this.config.parser(e,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:n,uneditableClass:this.config.uneditableContainerClassname,clearInternals:t});return"object"==typeof e&&r.quirks.redraw(e),o},_initParser:function(){this.on("paste:composer",function(){var e=!0,t=this;t.composer.selection.executeAndRestore(function(){r.quirks.cleanPastedHTML(t.composer.element),t.parse(t.composer.element)},e)})}})}(wysihtml5),function(a){var s=a.dom,l="wysihtml5-command-dialog-opened",c="input, select, textarea",d="[data-wysihtml5-dialog-field]",u="data-wysihtml5-dialog-field";a.toolbar.Dialog=a.lang.Dispatcher.extend({constructor:function(e,t){this.link=e,this.container=t},_observe:function(){if(!this._observed){var n=this,o=function(e){var t=n._serialize();t==n.elementToChange?n.fire("edit",t):n.fire("save",t),n.hide(),e.preventDefault(),e.stopPropagation()};s.observe(n.link,"click",function(){s.hasClass(n.link,l)&&setTimeout(function(){n.hide()},0)}),s.observe(this.container,"keydown",function(e){var t=e.keyCode;t===a.ENTER_KEY&&o(e),t===a.ESCAPE_KEY&&(n.fire("cancel"),n.hide())}),s.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",o),s.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){n.fire("cancel"),n.hide(),e.preventDefault(),e.stopPropagation()});for(var e=this.container.querySelectorAll(c),t=0,r=e.length,i=function(){clearInterval(n.interval)};t<r;t++)s.observe(e[t],"change",i);this._observed=!0}},_serialize:function(){for(var e=this.elementToChange||{},t=this.container.querySelectorAll(d),n=t.length,o=0;o<n;o++)e[t[o].getAttribute(u)]=t[o].value;return e},_interpolate:function(e){for(var t,n,o,r=document.querySelector(":focus"),i=this.container.querySelectorAll(d),a=i.length,s=0;s<a;s++)(t=i[s])!==r&&(e&&"hidden"===t.type||(n=t.getAttribute(u),o=this.elementToChange&&"boolean"!=typeof this.elementToChange?this.elementToChange.getAttribute(n)||"":t.defaultValue,t.value=o))},show:function(e){if(!s.hasClass(this.link,l)){var t=this,n=this.container.querySelector(c);if(this.elementToChange=e,this._observe(),this._interpolate(),e&&(this.interval=setInterval(function(){t._interpolate(!0)},500)),s.addClass(this.link,l),this.container.style.display="",this.fire("show"),n&&!e)try{n.focus()}catch(o){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,s.removeClass(this.link,l),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(a){var s=a.dom,l={position:"relative"},c={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},d={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},u={"x-webkit-speech":"",speech:""};a.toolbar.Speech=function(e,t){var n=document.createElement("input");if(a.browser.supportsSpeechApiOn(n)){var o=e.editor.textarea.element.getAttribute("lang");o&&(u.lang=o);var r=document.createElement("div");a.lang.object(c).merge({width:t.offsetWidth+"px",height:t.offsetHeight+"px"}),s.insert(n).into(r),s.insert(r).into(t),s.setStyles(d).on(n),s.setAttributes(u).on(n),s.setStyles(c).on(r),s.setStyles(l).on(t);var i="onwebkitspeechchange"in n?"webkitspeechchange":"speechchange";s.observe(n,i,function(){e.execCommand("insertText",n.value),n.value=""}),s.observe(n,"click",function(e){s.hasClass(t,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}else t.style.display="none"}}(wysihtml5),function(d){var a="wysihtml5-command-disabled",s="wysihtml5-commands-disabled",l="wysihtml5-command-active",c="wysihtml5-action-active",u=d.dom;d.toolbar.Toolbar=Base.extend({constructor:function(e,t,n){this.editor=e,this.container="string"==typeof t?document.getElementById(t):t,this.composer=e.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),n&&this.show();for(var o=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),r=o.length,i=0;i<r;i++)new d.toolbar.Speech(this,o[i])},_getLinks:function(e){for(var t,n,o,r,i,a=this[e+"Links"]=d.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+e+"]")).get(),s=a.length,l=0,c=this[e+"Mapping"]={};l<s;l++)o=(t=a[l]).getAttribute("data-wysihtml5-"+e),r=t.getAttribute("data-wysihtml5-"+e+"-value"),n=this.container.querySelector("[data-wysihtml5-"+e+"-group='"+o+"']"),i=this._getDialog(t,o),c[o+":"+r]={link:t,group:n,name:o,value:r,dialog:i,state:!1}},_getDialog:function(t,n){var e,o,r=this,i=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return i&&((e=d.toolbar["Dialog_"+n]?new d.toolbar["Dialog_"+n](t,i):new d.toolbar.Dialog(t,i)).on("show",function(){o=r.composer.selection.getBookmark(),r.editor.fire("show:dialog",{command:n,dialogContainer:i,commandLink:t})}),e.on("save",function(e){o&&r.composer.selection.setBookmark(o),r._execCommand(n,e),r.editor.fire("save:dialog",{command:n,dialogContainer:i,commandLink:t})}),e.on("cancel",function(){r.editor.focus(!1),r.editor.fire("cancel:dialog",{command:n,dialogContainer:i,commandLink:t})})),e},execCommand:function(e,t){if(!this.commandsDisabled){var n=this.commandMapping[e+":"+t];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(e,t)}},_execCommand:function(e,t){this.editor.focus(!1),this.composer.commands.exec(e,t),this._updateLinkStates()},execAction:function(e){var t=this.editor;"change_view"===e&&t.textarea&&(t.currentView===t.textarea?t.fire("change_view","composer"):t.fire("change_view","textarea")),"showSource"==e&&t.fire("showSource")},_observe:function(){for(var r=this,t=this.editor,n=this.container,e=this.commandLinks.concat(this.actionLinks),o=e.length,i=0;i<o;i++)"A"===e[i].nodeName?u.setAttributes({href:"javascript:;",unselectable:"on"}).on(e[i]):u.setAttributes({unselectable:"on"}).on(e[i]);u.delegate(n,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(e){e.preventDefault()}),u.delegate(n,"[data-wysihtml5-command]","click",function(e){var t=this,n=t.getAttribute("data-wysihtml5-command"),o=t.getAttribute("data-wysihtml5-command-value");r.execCommand(n,o),e.preventDefault()}),u.delegate(n,"[data-wysihtml5-action]","click",function(e){var t=this.getAttribute("data-wysihtml5-action");r.execAction(t),e.preventDefault()}),t.on("interaction:composer",function(){r._updateLinkStates()}),t.on("focus:composer",function(){r.bookmark=null}),this.editor.config.handleTables&&(t.on("tableselect:composer",function(){r.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),t.on("tableunselect:composer",function(){r.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})),t.on("change_view",function(e){t.textarea&&setTimeout(function(){r.commandsDisabled="composer"!==e,r._updateLinkStates(),r.commandsDisabled?u.addClass(n,s):u.removeClass(n,s)},0)})},_updateLinkStates:function(){var e,t,n,o,r=this.commandMapping,i=this.actionMapping;for(e in r)o=r[e],this.commandsDisabled?(t=!1,u.removeClass(o.link,l),o.group&&u.removeClass(o.group,l),o.dialog&&o.dialog.hide()):(t=this.composer.commands.state(o.name,o.value),u.removeClass(o.link,a),o.group&&u.removeClass(o.group,a)),o.state!==t&&((o.state=t)?(u.addClass(o.link,l),o.group&&u.addClass(o.group,l),o.dialog&&("object"==typeof t||d.lang.object(t).isArray()?(!o.dialog.multiselect&&d.lang.object(t).isArray()&&(t=1!==t.length||t[0],o.state=t),o.dialog.show(t)):o.dialog.hide())):(u.removeClass(o.link,l),o.group&&u.removeClass(o.group,l),o.dialog&&o.dialog.hide()));for(e in i)"change_view"===(n=i[e]).name&&(n.state=this.editor.currentView===this.editor.textarea,n.state?u.addClass(n.link,c):u.removeClass(n.link,c))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(e){e.toolbar.Dialog_createTable=e.toolbar.Dialog.extend({show:function(e){this.base(e)}})}(wysihtml5),function(c){c.dom;var d="[data-wysihtml5-dialog-field]",u="data-wysihtml5-dialog-field";c.toolbar.Dialog_foreColorStyle=c.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var e={},t=this.container.querySelectorAll(d),n=t.length,o=0;o<n;o++)e[t[o].getAttribute(u)]=t[o].value;return e},_interpolate:function(e){for(var t,n=document.querySelector(":focus"),o=this.container.querySelectorAll(d),r=o.length,i=0,a=this.elementToChange?c.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,s=a?a.getAttribute("style"):null,l=s?c.quirks.styleParser.parseColor(s,"color"):null;i<r;i++)(t=o[i])!==n&&(e&&"hidden"===t.type||"color"===t.getAttribute(u)&&(l?l[3]&&1!=l[3]?t.value="rgba("+l[0]+","+l[1]+","+l[2]+","+l[3]+");":t.value="rgb("+l[0]+","+l[1]+","+l[2]+");":t.value="rgb(0,0,0);"))}})}(wysihtml5),function(i){i.dom;i.toolbar.Dialog_fontSizeStyle=i.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(){var e=document.querySelector(":focus"),t=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),n=this.elementToChange?i.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,o=n?n.getAttribute("style"):null,r=o?i.quirks.styleParser.parseFontSize(o):null;t&&t!==e&&r&&!/^\s*$/.test(r)&&(t.value=r)}})}(wysihtml5),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.Handlebars=t():e.Handlebars=t()}(this,function(){return function(n){function o(e){if(r[e])return r[e].exports;var t=r[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}var r={};return o.m=n,o.c=r,o.p="",o(0)}([function(u,h,f){(function(e){"use strict";function t(){var t=new o.HandlebarsEnvironment;return a.extend(t,o),t.SafeString=r["default"],t.Exception=i["default"],t.Utils=a,t.escapeExpression=a.escapeExpression,t.VM=s,t.template=function(e){return s.template(e,t)},t}var n=f(6)["default"];h.__esModule=!0;var o=n(f(1)),r=n(f(2)),i=n(f(3)),a=n(f(4)),s=n(f(5)),l=t();l.create=t;var c=void 0!==e?e:window,d=c.Handlebars;l.noConflict=function(){c.Handlebars===l&&(c.Handlebars=d)},l["default"]=l,h["default"]=l,u.exports=h["default"]}).call(h,function(){return this}())},function(e,t,n){"use strict";function o(e,t){this.helpers=e||{},this.partials=t||{},r(this)}function r(i){i.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new m["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),i.registerHelper("blockHelperMissing",function(e,t){var n=t.inverse,o=t.fn;if(!0===e)return o(this);if(!1===e||null==e)return n(this);if(p(e))return 0<e.length?(t.ids&&(t.ids=[t.name]),i.helpers.each(e,t)):n(this);if(t.data&&t.ids){var r=h(t.data);r.contextPath=f.appendContextPath(t.data.contextPath,t.name),t={data:r}}return o(e,t)}),i.registerHelper("each",function(o,e){function t(e,t,n){s&&(s.key=e,s.index=t,s.first=0===t,s.last=!!n,l&&(s.contextPath=l+e)),a+=r(o[e],{data:s,blockParams:f.blockParams([o[e],e],[l+e,null])})}if(!e)throw new m["default"]("Must pass iterator to #each");var r=e.fn,n=e.inverse,i=0,a="",s=void 0,l=void 0;if(e.data&&e.ids&&(l=f.appendContextPath(e.data.contextPath,e.ids[0])+"."),g(o)&&(o=o.call(this)),e.data&&(s=h(e.data)),o&&"object"==typeof o)if(p(o))for(var c=o.length;i<c;i++)t(i,i,i===o.length-1);else{var d=void 0;for(var u in o)o.hasOwnProperty(u)&&(d&&t(d,i-1),d=u,i++);d&&t(d,i-1,!0)}return 0===i&&(a=n(this)),a}),i.registerHelper("if",function(e,t){return g(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||f.isEmpty(e)?t.inverse(this):t.fn(this)}),i.registerHelper("unless",function(e,t){return i.helpers["if"].call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})}),i.registerHelper("with",function(e,t){g(e)&&(e=e.call(this));var n=t.fn;if(f.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var o=h(t.data);o.contextPath=f.appendContextPath(t.data.contextPath,t.ids[0]),t={data:o}}return n(e,t)}),i.registerHelper("log",function(e,t){var n=t.data&&null!=t.data.level?parseInt(t.data.level,10):1;i.log(n,e)}),i.registerHelper("lookup",function(e,t){return e&&e[t]})}function h(e){var t=f.extend({},e);return t._parent=e,t}var i=n(6)["default"];t.__esModule=!0,t.HandlebarsEnvironment=o,t.createFrame=h;var f=i(n(4)),m=i(n(3)),a="3.0.1";t.VERSION=a;var s=6;t.COMPILER_REVISION=s;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};t.REVISION_CHANGES=l;var p=f.isArray,g=f.isFunction,c=f.toString,d="[object Object]";o.prototype={constructor:o,logger:u,log:y,registerHelper:function(e,t){if(c.call(e)===d){if(t)throw new m["default"]("Arg not supported with multiple helpers");f.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(c.call(e)===d)f.extend(this.partials,e);else{if(void 0===t)throw new m["default"]("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var u={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&u.level<=e){var n=u.methodMap[e];(console[n]||console.log).call(console,t)}}},y=(t.logger=u).log;t.log=y},function(e,t){"use strict";function n(e){this.string=e}t.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t["default"]=n,e.exports=t["default"]},function(e,t){"use strict";function s(e,t){var n=t&&t.loc,o=void 0,r=void 0;n&&(e+=" - "+(o=n.start.line)+":"+(r=n.start.column));for(var i=Error.prototype.constructor.call(this,e),a=0;a<l.length;a++)this[l[a]]=i[l[a]];Error.captureStackTrace&&Error.captureStackTrace(this,s),n&&(this.lineNumber=o,this.column=r)}t.__esModule=!0;var l=["description","fileName","lineNumber","message","name","number","stack"];s.prototype=new Error,t["default"]=s,e.exports=t["default"]},function(e,t){"use strict";function n(e){return d[e]}function o(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function r(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function i(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return h.test(e)?e.replace(u,n):e}function a(e){return!e&&0!==e||!(!m(e)||0!==e.length)}function s(e,t){return e.path=t,e}function l(e,t){return(e?e+".":"")+t}t.__esModule=!0,t.extend=o,t.indexOf=r,t.escapeExpression=i,t.isEmpty=a,t.blockParams=s,t.appendContextPath=l;var c,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,h=/[&<>"'`]/,f=Object.prototype.toString;t.toString=f,(c=function(e){return"function"==typeof e})(/x/)&&(t.isFunction=c=function(e){return"function"==typeof e&&"[object Function]"===f.call(e)}),t.isFunction=c;var m=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===f.call(e)};t.isArray=m},function(e,t,n){"use strict";function o(e){var t=e&&e[0]||1,n=c.COMPILER_REVISION;if(t!==n){if(t<n){var o=c.REVISION_CHANGES[n],r=c.REVISION_CHANGES[t];throw new f["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+o+") or downgrade your runtime to an older version ("+r+").")}throw new f["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function r(s,l){function e(e,t,n){n.hash&&(t=h.extend({},t,n.hash)),e=l.VM.resolvePartial.call(this,e,t,n);var o=l.VM.invokePartial.call(this,e,t,n);if(null==o&&l.compile&&(n.partials[n.name]=l.compile(e,s.compilerOptions,l),o=n.partials[n.name](t,n)),null!=o){if(n.indent){for(var r=o.split("\n"),i=0,a=r.length;i<a&&(r[i]||i+1!==a);i++)r[i]=n.indent+r[i];o=r.join("\n")}return o}throw new f["default"]("The partial "+n.name+" could not be compiled when running in runtime-only mode")}function a(e,t){var n=void 0===t?{}:t,o=n.data;a._setup(n),!n.partial&&s.useData&&(o=u(e,o));var r=void 0,i=s.useBlockParams?[]:void 0;return s.useDepths&&(r=n.depths?[e].concat(n.depths):[e]),s.main.call(c,e,c.helpers,c.partials,o,i,r)}if(!l)throw new f["default"]("No environment passed to template");if(!s||!s.main)throw new f["default"]("Unknown template object: "+typeof s);l.VM.checkRevision(s.compiler);var c={strict:function(e,t){if(!(t in e))throw new f["default"]('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,o=0;o<n;o++)if(e[o]&&null!=e[o][t])return e[o][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:e,fn:function(e){return s[e]},programs:[],program:function(e,t,n,o,r){var i=this.programs[e],a=this.fn(e);return t||r||o||n?i=d(this,e,a,t,n,o,r):i||(i=this.programs[e]=d(this,e,a)),i},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=h.extend({},t,e)),n},noop:l.VM.noop,compilerInfo:s.compiler};return a.isTop=!0,a._setup=function(e){e.partial?(c.helpers=e.helpers,c.partials=e.partials):(c.helpers=c.merge(e.helpers,l.helpers),s.usePartial&&(c.partials=c.merge(e.partials,l.partials)))},a._child=function(e,t,n,o){if(s.useBlockParams&&!n)throw new f["default"]("must pass block params");if(s.useDepths&&!o)throw new f["default"]("must pass parent depths");return d(c,e,s[e],t,0,n,o)},a}function d(o,e,r,i,t,a,s){function n(e,t){var n=void 0===t?{}:t;return r.call(o,e,o.helpers,o.partials,n.data||i,a&&[n.blockParams].concat(a),s&&[e].concat(s))}return n.program=e,n.depth=s?s.length:0,n.blockParams=t||0,n}function i(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e=n.partials[n.name],e}function a(e,t,n){if(n.partial=!0,void 0===e)throw new f["default"]("The partial "+n.name+" could not be found");return e instanceof Function?e(t,n):void 0}function s(){return""}function u(e,t){return t&&"root"in t||((t=t?c.createFrame(t):{}).root=e),t}var l=n(6)["default"];t.__esModule=!0,t.checkRevision=o,t.template=r,t.wrapProgram=d,t.resolvePartial=i,t.invokePartial=a,t.noop=s;var h=l(n(4)),f=l(n(3)),c=n(1)},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0}])}),this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.blockquote=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-quote-left"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-quote"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r;return'<li>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.color=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.black:r,e))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.black:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.silver:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.gray:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.maroon:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.red:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.purple:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.green:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.olive:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.navy:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.blue:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.orange:r,e))+"</a></li>\n  </ul>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.emphasis=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(e,t,n,o){var r;return'    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.small:r,e))+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.bold:r,e))+'</a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.italic:r,e))+'</a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.underline:r,e))+"</a>\n"+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.emphasis:r)?r.small:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+"  </div>\n</li>\n"},useData:!0}),this.wysihtml5.tpl["font-styles"]=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-font"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-font"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'" data-toggle="dropdown">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+'    <span class="current-font">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.normal:r,e))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.normal:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h1:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h2:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h3:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h4:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h5:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h6:r,e))+"</a></li>\n  </ul>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.html=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'        <span class="fa fa-pencil"></span>\n'},5:function(){return'        <span class="glyphicon glyphicon-pencil"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-action="change_view" title="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.locale:e)?r.html:r)?r.edit:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+"    </a>\n  </div>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.image=Handlebars.template({1:function(){return"modal-sm"},3:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},5:function(){return'      <span class="fa fa-file-image-o"></span>\n'},7:function(){return'      <span class="glyphicon glyphicon-picture"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.smallmodals:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.cancel:r,e))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertImage" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(5,o,0),inverse:this.program(7,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.link=Handlebars.template({1:function(){return"modal-sm"},3:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},5:function(){return'      <span class="fa fa-share-square-o"></span>\n'},7:function(){return'      <span class="glyphicon glyphicon-share"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.smallmodals:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o
}))?r:"")+'">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.target:r,e))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.cancel:r,e))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="createLink" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(5,o,0),inverse:this.program(7,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.lists=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-list-ul"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-list"></span>\n'},7:function(){return'      <span class="fa fa-list-ol"></span>\n'},9:function(){return'      <span class="glyphicon glyphicon-th-list"></span>\n'},11:function(){return'      <span class="fa fa-outdent"></span>\n'},13:function(){return'      <span class="glyphicon glyphicon-indent-right"></span>\n'},15:function(){return'      <span class="fa fa-indent"></span>\n'},17:function(){return'      <span class="glyphicon glyphicon-indent-left"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.unordered:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertOrderedList" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.ordered:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(7,o,0),inverse:this.program(9,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="Outdent" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.outdent:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(11,o,0),inverse:this.program(13,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="Indent" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.indent:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(15,o,0),inverse:this.program(17,o,0),data:o}))?r:"")+"    </a>\n  </div>\n</li>\n"},useData:!0}),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],e):e(jQuery,wysihtml5)}(function(e,t){(function(s,a){"use strict";var l=function(e,t,n){if(a.tpl[e])return a.tpl[e]({locale:t,options:n})},n=function(e,t){this.el=e;var n=s.extend(!0,{},c,t);for(var o in n.customTemplates)a.tpl[o]=n.customTemplates[o];this.toolbar=this.createToolbar(e,n),this.editor=this.createEditor(n)};n.prototype={constructor:n,createEditor:function(e){e=e||{},(e=s.extend(!0,{},e)).toolbar=this.toolbar[0];var t=new a.Editor(this.el[0],e);if(t.composer.editableArea.contentDocument?this.addMoreShortcuts(t,t.composer.editableArea.contentDocument.body||t.composer.editableArea.contentDocument,e.shortcuts):this.addMoreShortcuts(t,t.composer.editableArea,e.shortcuts),e&&e.events)for(var n in e.events)t.on(n,e.events[n]);return t.on("beforeload",this.syncBootstrapDialogEvents),t},syncBootstrapDialogEvents:function(){var t=this;s.map(this.toolbar.commandMapping,function(e){return[e]}).filter(function(e){return e.dialog}).map(function(e){return e.dialog}).forEach(function(e){e.on("show",function(){s(this.container).modal("show")}),e.on("hide",function(){s(this.container).modal("hide"),t.composer.focus()}),s(e.container).on("shown.bs.modal",function(){s(this).find("input, select, textarea").first().focus()})})},createToolbar:function(e,t){var i=this,n=s("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),o=t.locale||c.locale||"en";d.hasOwnProperty(o)||(console.debug("Locale '"+o+"' not found. Available locales are: "+Object.keys(d)+". Falling back to 'en'."),o="en");var r=s.extend(!0,{},d.en,d[o]);for(var a in t.toolbar)t.toolbar[a]&&(n.append(l(a,r,t)),"html"===a&&this.initHtml(n));return n.find('a[data-wysihtml5-command="formatBlock"]').click(function(e){var t=e.delegateTarget||e.target||e.srcElement,n=s(t),o=n.data("wysihtml5-display-format-name"),r=n.data("wysihtml5-format-name")||n.html();o!==undefined&&"true"!==o||i.toolbar.find(".current-font").text(r)}),n.find('a[data-wysihtml5-command="foreColor"]').click(function(e){var t=e.target||e.srcElement,n=s(t);i.toolbar.find(".current-color").text(n.html())}),this.el.before(n),n},initHtml:function(e){var t='a[data-wysihtml5-action="change_view"]';e.find(t).click(function(){e.find("a.btn").not(t).toggleClass("disabled")})},addMoreShortcuts:function(r,e,i){a.dom.observe(e,"keydown",function(e){var t=e.keyCode,n=i[t];if((e.ctrlKey||e.metaKey||e.altKey)&&n&&a.commands[n]){var o=r.toolbar.commandMapping[n+":null"];o&&o.dialog&&!o.state?o.dialog.show():a.commands[n].exec(r.composer,n),e.preventDefault()}})}};var o={resetDefaults:function(){s.fn.wysihtml5.defaultOptions=s.extend(!0,{},s.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(t){return this.each(function(){var e=s(this);e.data("wysihtml5",new n(e,t))})},shallowExtend:function(e){var t=s.extend({},s.fn.wysihtml5.defaultOptions,e||{},s(this).data()),n=this;return o.bypassDefaults.apply(n,[t])},deepExtend:function(e){var t=s.extend(!0,{},s.fn.wysihtml5.defaultOptions,e||{}),n=this;return o.bypassDefaults.apply(n,[t])},init:function(e){var t=this;return o.shallowExtend.apply(t,[e])}};s.fn.wysihtml5=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void s.error("Method "+e+" does not exist on jQuery.wysihtml5"):o.init.apply(this,arguments)},s.fn.wysihtml5.Constructor=n;var c=s.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small"}};"undefined"==typeof s.fn.wysihtml5.defaultOptionsCache&&(s.fn.wysihtml5.defaultOptionsCache=s.extend(!0,{},s.fn.wysihtml5.defaultOptions));var d=s.fn.wysihtml5.locale={}})(e,t)}),function(n){n.commands.small={exec:function(e,t){return n.commands.formatInline.exec(e,t,"small")},state:function(e,t){return n.commands.formatInline.state(e,t,"small")}}}(wysihtml5),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],e):e(jQuery)}(function(e){e.fn.wysihtml5.locale.en=e.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}});